<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>spark_tutorial_student</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://localhost:8001/static/base/images/favicon.ico?v=30780f272ab4aac64aa073a841546240">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="spark_tutorial_student.read-only_files/jquery-ui.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="spark_tutorial_student.read-only_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "https://cdn.mathjax.org/mathjax/latest/MathJax.js";
</script>

<link rel="stylesheet" href="spark_tutorial_student.read-only_files/bootstrap-tour.css" type="text/css">
<link rel="stylesheet" href="spark_tutorial_student.read-only_files/codemirror.css">


    <link rel="stylesheet" href="spark_tutorial_student.read-only_files/style.css" type="text/css">
    

<link rel="stylesheet" href="spark_tutorial_student.read-only_files/override.css" type="text/css">
<link rel="stylesheet" href="" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="spark_tutorial_student.read-only_files/custom.css" type="text/css">
    <script src="spark_tutorial_student.read-only_files/promise.js" type="text/javascript" charset="utf-8"></script>
    <script src="spark_tutorial_student.read-only_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20150614145417",
          
          baseUrl: '/static/',
          paths: {
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/term.js/src/term',
          },
          shim: {
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            jqueryui: {
              deps: ["jquery"],
              exports: "$"
            }
          }
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });
    </script>

    
    

<script src="spark_tutorial_student.read-only_files/namespace.js" data-requiremodule="base/js/namespace" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/jquery.js" data-requiremodule="jquery" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/notebook.js" data-requiremodule="notebook/js/notebook" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/contents.js" data-requiremodule="services/contents" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/config.js" data-requiremodule="services/config" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/utils.js" data-requiremodule="base/js/utils" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/page.js" data-requiremodule="base/js/page" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/events.js" data-requiremodule="base/js/events" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/loginwidget.js" data-requiremodule="auth/js/loginwidget" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/maintoolbar.js" data-requiremodule="notebook/js/maintoolbar" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/pager.js" data-requiremodule="notebook/js/pager" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/quickhelp.js" data-requiremodule="notebook/js/quickhelp" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/menubar.js" data-requiremodule="notebook/js/menubar" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/notificationarea.js" data-requiremodule="notebook/js/notificationarea" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/savewidget.js" data-requiremodule="notebook/js/savewidget" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/actions.js" data-requiremodule="notebook/js/actions" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/keyboardmanager.js" data-requiremodule="notebook/js/keyboardmanager" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/kernelselector.js" data-requiremodule="notebook/js/kernelselector" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/codemirror.js" data-requiremodule="codemirror/lib/codemirror" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/about.js" data-requiremodule="notebook/js/about" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/custom.js" data-requiremodule="custom/custom" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/dialog.js" data-requiremodule="base/js/dialog" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/keyboard.js" data-requiremodule="base/js/keyboard" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/moment.js" data-requiremodule="moment" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/notificationarea_002.js" data-requiremodule="base/js/notificationarea" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/tour.js" data-requiremodule="notebook/js/tour" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/toolbar.js" data-requiremodule="notebook/js/toolbar" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/celltoolbar.js" data-requiremodule="notebook/js/celltoolbar" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/meta.js" data-requiremodule="codemirror/mode/meta" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/cell.js" data-requiremodule="notebook/js/cell" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/textcell.js" data-requiremodule="notebook/js/textcell" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/codecell.js" data-requiremodule="notebook/js/codecell" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/session.js" data-requiremodule="services/sessions/session" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/marked.js" data-requiremodule="components/marked/lib/marked" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/runmode.js" data-requiremodule="codemirror/addon/runmode/runmode" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/mathjaxutils.js" data-requiremodule="notebook/js/mathjaxutils" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/tooltip.js" data-requiremodule="notebook/js/tooltip" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/default.js" data-requiremodule="notebook/js/celltoolbarpresets/default" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/rawcell.js" data-requiremodule="notebook/js/celltoolbarpresets/rawcell" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/slideshow.js" data-requiremodule="notebook/js/celltoolbarpresets/slideshow" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/scrollmanager.js" data-requiremodule="notebook/js/scrollmanager" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/bootstrap.js" data-requiremodule="bootstrap" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/jquery-ui.js" data-requiremodule="jqueryui" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/notificationwidget.js" data-requiremodule="base/js/notificationwidget" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/underscore-min.js" data-requiremodule="underscore" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/matchbrackets.js" data-requiremodule="codemirror/addon/edit/matchbrackets" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/closebrackets.js" data-requiremodule="codemirror/addon/edit/closebrackets" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/comment.js" data-requiremodule="codemirror/addon/comment/comment" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/security.js" data-requiremodule="base/js/security" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/gfm.js" data-requiremodule="codemirror/mode/gfm/gfm" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/codemirror-ipythongfm.js" data-requiremodule="notebook/js/codemirror-ipythongfm" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/outputarea.js" data-requiremodule="notebook/js/outputarea" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/completer.js" data-requiremodule="notebook/js/completer" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/python.js" data-requiremodule="codemirror/mode/python/python" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/codemirror-ipython.js" data-requiremodule="notebook/js/codemirror-ipython" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/kernel.js" data-requiremodule="services/kernels/kernel" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/bootstrap-tour.js" data-requiremodule="bootstraptour" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/html-css-sanitizer-minified.js" data-requiremodule="components/google-caja/html-css-sanitizer-minified" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/markdown.js" data-requiremodule="codemirror/mode/markdown/markdown" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/overlay.js" data-requiremodule="codemirror/addon/mode/overlay" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/multiplex.js" data-requiremodule="codemirror/addon/mode/multiplex" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/stex.js" data-requiremodule="codemirror/mode/stex/stex" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/contexthint.js" data-requiremodule="notebook/js/contexthint" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/comm.js" data-requiremodule="services/kernels/comm" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/serialize.js" data-requiremodule="services/kernels/serialize" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/init.js" data-requiremodule="widgets/js/init" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/manager.js" data-requiremodule="widgets/js/manager" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_link.js" data-requiremodule="widgets/js/widget_link" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_bool.js" data-requiremodule="widgets/js/widget_bool" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_button.js" data-requiremodule="widgets/js/widget_button" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_box.js" data-requiremodule="widgets/js/widget_box" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_float.js" data-requiremodule="widgets/js/widget_float" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_image.js" data-requiremodule="widgets/js/widget_image" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_int.js" data-requiremodule="widgets/js/widget_int" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_output.js" data-requiremodule="widgets/js/widget_output" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_selection.js" data-requiremodule="widgets/js/widget_selection" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_selectioncontainer.js" data-requiremodule="widgets/js/widget_selectioncontainer" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget_string.js" data-requiremodule="widgets/js/widget_string" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/xml.js" data-requiremodule="codemirror/mode/xml/xml" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/widget.js" data-requiremodule="widgets/js/widget" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><script src="spark_tutorial_student.read-only_files/backbone-min.js" data-requiremodule="backbone" data-requirecontext="_" async="" charset="utf-8" type="text/javascript"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body class="notebook_app command_mode" data-project="" data-base-url="/" data-ws-url="" data-notebook-name="spark_tutorial_student.ipynb" data-notebook-path="spark_tutorial/spark_tutorial_student.ipynb"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div style="display: none;" id="MathJax_Message"></div>

<noscript>
    <div id='noscript'>
      IPython Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div style="display: block;" id="header">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://localhost:8001/tree" title="dashboard"><img src="spark_tutorial_student.read-only_files/logo.png" alt="Jupyter Notebook"></a></div>

  

  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">spark_tutorial_student</span>
    <span title="Sun, Jun 14, 2015 9:28 PM" class="checkpoint_status">Last Checkpoint: 8 minutes ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  <img style="display: inline;" class="current_kernel_logo" src="spark_tutorial_student.read-only_files/logo-64x64.png">
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 2</span>
              <i title="Kernel Idle" class="kernel_idle_icon" id="kernel_indicator_icon"></i>
            </p>
            <i style="display: none;" id="readonly-indicator" class="navbar-text" title="This notebook is read-only">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i title="Command Mode" id="modal_indicator" class="navbar-text modal_indicator"></i>
            <span id="notification_area"><div style="display: none;" class="notification_widget btn btn-xs navbar-btn undefined info" id="notification_kernel"><span></span></div><div style="display: none;" class="notification_widget btn btn-xs navbar-btn" id="notification_notebook"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a aria-expanded="false" href="#" class="dropdown-toggle" data-toggle="dropdown">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python2"><a href="#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook's contents and start a new kernel">
                            <a href="#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="#">Sunday, June 14, 2015 9:28 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="#">Download as</a>
                            <ul class="dropdown-menu">
                                <li id="download_ipynb"><a href="#">IPython Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="#">Python (.py)</a></li>
                                <li id="download_html"><a href="#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="#">reST (.rst)</a></li>
                                <li id="download_pdf"><a href="#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li class="disabled" id="trust_notebook" title="Trust the output of this notebook">
                            <a href="#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook's kernel, and close this window">
                            <a href="#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a aria-expanded="false" href="#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="#">Cut Cell</a></li>
                        <li id="copy_cell"><a href="#">Copy Cell</a></li>
                        <li id="paste_cell_above" class=""><a href="#">Paste Cell Above</a></li>
                        <li id="paste_cell_below" class=""><a href="#">Paste Cell Below</a></li>
                        <li id="paste_cell_replace" class=""><a href="#">Paste Cell &amp; Replace</a></li>
                        <li id="delete_cell"><a href="#">Delete Cell</a></li>
                        <li id="undelete_cell" class=""><a href="#">Undo Delete Cell</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="#">Edit Notebook Metadata</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the IPython Notebook logo and notebook title (above menu bar)">
                            <a href="#">Toggle Header</a></li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="#">Toggle Toolbar</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a aria-expanded="false" href="#" class="dropdown-toggle" data-toggle="dropdown">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a aria-expanded="false" href="#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="#">Run</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="#">Run and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="#">Run and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as 'Code' cells">
                            <a href="#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="#">Current Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="#">Restart</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="#">Reconnect</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="#">Python 2</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="#">Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Notebook Help
                                </a></li>
                            
                                <li><a href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                <i class="fa fa-external-link menu-icon pull-right"></i>
                                Markdown
                                </a></li>
                            
                            
                        
                        <li class="divider" id="kernel-help-links"></li><li><a href="http://docs.python.org/2.7" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a href="http://ipython.org/documentation.html" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a href="http://docs.scipy.org/doc/numpy/reference/" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a href="http://docs.scipy.org/doc/scipy/reference/" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a href="http://matplotlib.org/contents.html" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a href="http://docs.sympy.org/latest/index.html" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a href="http://pandas.pydata.org/pandas-docs/stable/" title="Opens in a new window" target="_blank"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About IPython Notebook"><a id="notebook_about" href="#">About</a></li>
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div id="save-notbook" class="btn-group"><button data-jupyter-action="ipython.save-notebook" title="Save and Checkpoint" class="btn btn-default"><i class="fa-save fa"></i></button></div><div id="insert_above_below" class="btn-group"><button data-jupyter-action="ipython.insert-cell-after" title="insert cell below" class="btn btn-default"><i class="fa-plus fa"></i></button></div><div id="cut_copy_paste" class="btn-group"><button data-jupyter-action="ipython.cut-selected-cell" title="cut selected cell" class="btn btn-default"><i class="fa-cut fa"></i></button><button data-jupyter-action="ipython.copy-selected-cell" title="copy selected cell" class="btn btn-default"><i class="fa-copy fa"></i></button><button data-jupyter-action="ipython.paste-cell-after" title="paste cell below" class="btn btn-default"><i class="fa-paste fa"></i></button></div><div id="move_up_down" class="btn-group"><button data-jupyter-action="ipython.move-selected-cell-up" title="move selected cell up" class="btn btn-default"><i class="fa-arrow-up fa"></i></button><button data-jupyter-action="ipython.move-selected-cell-down" title="move selected cell down" class="btn btn-default"><i class="fa-arrow-down fa"></i></button></div><div id="run_int" class="btn-group"><button data-jupyter-action="ipython.run-select-next" title="run cell, select below" class="btn btn-default"><i class="fa-play fa"></i></button><button data-jupyter-action="ipython.interrupt-kernel" title="interrupt kernel" class="btn btn-default"><i class="fa-stop fa"></i></button><button data-jupyter-action="ipython.restart-kernel" title="restart kernel" class="btn btn-default"><i class="fa-repeat fa"></i></button></div><select class="form-control select-xs" id="cell_type"><option selected="selected" value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option></select><div class="btn-group"><span class="navbar-text">Cell Toolbar:</span><select class="form-control select-xs" id="ctb_select"><option selected="selected" value="">None</option><option value="Edit Metadata">Edit Metadata</option><option value="Raw Cell Format">Raw Cell Format</option><option value="Slideshow">Slideshow</option></select></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div style="display: block; height: 674px;" id="site">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div tabindex="-1" id="notebook"><div id="notebook-container" class="container"><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 950px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 26.225px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-1">#</span><span class="cm-tag">![Spark Logo]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/ta_Spark-logo-small.png)</span><span class="cm-header cm-header-1"> + </span><span class="cm-tag">![Python Logo]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/python-logo-master-v3-TM-flattened_small.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-1"># </span><span class="cm-strong cm-header cm-header-1">**Spark Tutorial: Learning Apache Spark**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### This tutorial will teach you how to use </span><span class="cm-link cm-header cm-header-4">[Apache Spark]</span><span class="cm-string">(http://spark.apache.org/)</span><span class="cm-header cm-header-4">, a framework for large-scale data processing, within a notebook. Many traditional frameworks were designed to be run on a single computer.  However, many datasets today are too large to be stored on a single computer, and even when a dataset can be stored on one computer (such as the datasets in this tutorial), the dataset can often be processed much more quickly using multiple computers.  Spark has efficient implementations of a number of transformations and actions that can be composed together to perform data processing and analysis.  Spark excels at distributing these operations across a cluster while abstracting away many of the underlying implementation details.  Spark has been designed with a focus on scalability and efficiency.  With Spark you can begin developing your solution on your laptop, using a small dataset, and then use that same code to process terabytes or even petabytes across a distributed cluster.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**During this tutorial we will cover:**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 1:*</span><span class="cm-header cm-header-4"> Basic notebook usage and </span><span class="cm-link cm-header cm-header-4">[Python]</span><span class="cm-string">(https://docs.python.org/2/)</span><span class="cm-header cm-header-4"> integration</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 2:*</span><span class="cm-header cm-header-4"> An introduction to using </span><span class="cm-link cm-header cm-header-4">[Apache Spark]</span><span class="cm-string">(https://spark.apache.org/)</span><span class="cm-header cm-header-4"> with the Python </span><span class="cm-link cm-header cm-header-4">[pySpark API]</span><span class="cm-string">(https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)</span><span class="cm-header cm-header-4"> running in the browser</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 3:*</span><span class="cm-header cm-header-4"> Using RDDs and chaining together transformations and actions</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 4:*</span><span class="cm-header cm-header-4"> Lambda functions</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 5:*</span><span class="cm-header cm-header-4"> Additional RDD actions</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 6:*</span><span class="cm-header cm-header-4"> Additional RDD transformations</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 7:*</span><span class="cm-header cm-header-4"> Caching RDDs and storage options</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-em cm-header cm-header-4">*Part 8:*</span><span class="cm-header cm-header-4"> Debugging Spark applications and lazy evaluation</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The following transformations will be covered:</span></span></pre><pre class=""><span><span class="cm-variable-2">* #### </span><span class="cm-comment cm-variable-2">`map()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`mapPartitions()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`mapPartitionsWithIndex()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`filter()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`flatMap()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`reduceByKey()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`groupByKey()`</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The following actions will be covered:</span></span></pre><pre class=""><span><span class="cm-variable-2">* #### </span><span class="cm-comment cm-variable-2">`first()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`take()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`takeSample()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`takeOrdered()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`collect()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`count()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`countByValue()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`reduce()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`top()`</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Also covered:</span></span></pre><pre class=""><span><span class="cm-variable-2">* #### </span><span class="cm-comment cm-variable-2">`cache()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`unpersist()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`id()`</span><span class="cm-variable-2">, </span><span class="cm-comment cm-variable-2">`setName()`</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Note that, for reference, you can look up the details of these methods in </span><span class="cm-link cm-header cm-header-4">[Spark's Python API]</span><span class="cm-string">(https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 950px;"></div><div style="display: none; height: 980px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h1 id="-+-"><img src="spark_tutorial_student.read-only_files/ta_Spark-logo-small.png" alt="Spark Logo"> + <img src="spark_tutorial_student.read-only_files/python-logo-master-v3-TM-flattened_small.png" alt="Python Logo"><a href="#-+-" class="anchor-link">¶</a></h1>
<h1 id="Spark-Tutorial:-Learning-Apache-Spark"><strong>Spark Tutorial: Learning Apache Spark</strong><a href="#Spark-Tutorial:-Learning-Apache-Spark" class="anchor-link">¶</a></h1>
<h4 id="This-tutorial-will-teach-you-how-to-use-Apache-Spark,-a-framework-for-large-scale-data-processing,-within-a-notebook.-Many-traditional-frameworks-were-designed-to-be-run-on-a-single-computer.--However,-many-datasets-today-are-too-large-to-be-stored-on-a-single-computer,-and-even-when-a-dataset-can-be-stored-on-one-computer-(such-as-the-datasets-in-this-tutorial),-the-dataset-can-often-be-processed-much-more-quickly-using-multiple-computers.--Spark-has-efficient-implementations-of-a-number-of-transformations-and-actions-that-can-be-composed-together-to-perform-data-processing-and-analysis.--Spark-excels-at-distributing-these-operations-across-a-cluster-while-abstracting-away-many-of-the-underlying-implementation-details.--Spark-has-been-designed-with-a-focus-on-scalability-and-efficiency.--With-Spark-you-can-begin-developing-your-solution-on-your-laptop,-using-a-small-dataset,-and-then-use-that-same-code-to-process-terabytes-or-even-petabytes-across-a-distributed-cluster.">This tutorial will teach you how to use <a target="_blank" href="http://spark.apache.org/">Apache Spark</a>,
 a framework for large-scale data processing, within a notebook. Many 
traditional frameworks were designed to be run on a single computer.  
However, many datasets today are too large to be stored on a single 
computer, and even when a dataset can be stored on one computer (such as
 the datasets in this tutorial), the dataset can often be processed much
 more quickly using multiple computers.  Spark has efficient 
implementations of a number of transformations and actions that can be 
composed together to perform data processing and analysis.  Spark excels
 at distributing these operations across a cluster while abstracting 
away many of the underlying implementation details.  Spark has been 
designed with a focus on scalability and efficiency.  With Spark you can
 begin developing your solution on your laptop, using a small dataset, 
and then use that same code to process terabytes or even petabytes 
across a distributed cluster.<a href="#This-tutorial-will-teach-you-how-to-use-Apache-Spark,-a-framework-for-large-scale-data-processing,-within-a-notebook.-Many-traditional-frameworks-were-designed-to-be-run-on-a-single-computer.--However,-many-datasets-today-are-too-large-to-be-stored-on-a-single-computer,-and-even-when-a-dataset-can-be-stored-on-one-computer-%28such-as-the-datasets-in-this-tutorial%29,-the-dataset-can-often-be-processed-much-more-quickly-using-multiple-computers.--Spark-has-efficient-implementations-of-a-number-of-transformations-and-actions-that-can-be-composed-together-to-perform-data-processing-and-analysis.--Spark-excels-at-distributing-these-operations-across-a-cluster-while-abstracting-away-many-of-the-underlying-implementation-details.--Spark-has-been-designed-with-a-focus-on-scalability-and-efficiency.--With-Spark-you-can-begin-developing-your-solution-on-your-laptop,-using-a-small-dataset,-and-then-use-that-same-code-to-process-terabytes-or-even-petabytes-across-a-distributed-cluster." class="anchor-link">¶</a></h4>
<h4 id="During-this-tutorial-we-will-cover:"><strong>During this tutorial we will cover:</strong><a href="#During-this-tutorial-we-will-cover:" class="anchor-link">¶</a></h4>
<h4 id="Part-1:-Basic-notebook-usage-and-Python-integration"><em>Part 1:</em> Basic notebook usage and <a target="_blank" href="https://docs.python.org/2/">Python</a> integration<a href="#Part-1:-Basic-notebook-usage-and-Python-integration" class="anchor-link">¶</a></h4>
<h4 id="Part-2:-An-introduction-to-using-Apache-Spark-with-the-Python-pySpark-API-running-in-the-browser"><em>Part 2:</em> An introduction to using <a target="_blank" href="https://spark.apache.org/">Apache Spark</a> with the Python <a target="_blank" href="https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD">pySpark API</a> running in the browser<a href="#Part-2:-An-introduction-to-using-Apache-Spark-with-the-Python-pySpark-API-running-in-the-browser" class="anchor-link">¶</a></h4>
<h4 id="Part-3:-Using-RDDs-and-chaining-together-transformations-and-actions"><em>Part 3:</em> Using RDDs and chaining together transformations and actions<a href="#Part-3:-Using-RDDs-and-chaining-together-transformations-and-actions" class="anchor-link">¶</a></h4>
<h4 id="Part-4:-Lambda-functions"><em>Part 4:</em> Lambda functions<a href="#Part-4:-Lambda-functions" class="anchor-link">¶</a></h4>
<h4 id="Part-5:-Additional-RDD-actions"><em>Part 5:</em> Additional RDD actions<a href="#Part-5:-Additional-RDD-actions" class="anchor-link">¶</a></h4>
<h4 id="Part-6:-Additional-RDD-transformations"><em>Part 6:</em> Additional RDD transformations<a href="#Part-6:-Additional-RDD-transformations" class="anchor-link">¶</a></h4>
<h4 id="Part-7:-Caching-RDDs-and-storage-options"><em>Part 7:</em> Caching RDDs and storage options<a href="#Part-7:-Caching-RDDs-and-storage-options" class="anchor-link">¶</a></h4>
<h4 id="Part-8:-Debugging-Spark-applications-and-lazy-evaluation"><em>Part 8:</em> Debugging Spark applications and lazy evaluation<a href="#Part-8:-Debugging-Spark-applications-and-lazy-evaluation" class="anchor-link">¶</a></h4>
<h4 id="The-following-transformations-will-be-covered:">The following transformations will be covered:<a href="#The-following-transformations-will-be-covered:" class="anchor-link">¶</a></h4>
<ul>
<li><h4 id="map(),-mapPartitions(),-mapPartitionsWithIndex(),-filter(),-flatMap(),-reduceByKey(),-groupByKey()"><code>map()</code>, <code>mapPartitions()</code>, <code>mapPartitionsWithIndex()</code>, <code>filter()</code>, <code>flatMap()</code>, <code>reduceByKey()</code>, <code>groupByKey()</code><a href="#map%28%29,-mapPartitions%28%29,-mapPartitionsWithIndex%28%29,-filter%28%29,-flatMap%28%29,-reduceByKey%28%29,-groupByKey%28%29" class="anchor-link">¶</a></h4>
<h4 id="The-following-actions-will-be-covered:">The following actions will be covered:<a href="#The-following-actions-will-be-covered:" class="anchor-link">¶</a></h4>
</li>
<li><h4 id="first(),-take(),-takeSample(),-takeOrdered(),-collect(),-count(),-countByValue(),-reduce(),-top()"><code>first()</code>, <code>take()</code>, <code>takeSample()</code>, <code>takeOrdered()</code>, <code>collect()</code>, <code>count()</code>, <code>countByValue()</code>, <code>reduce()</code>, <code>top()</code><a href="#first%28%29,-take%28%29,-takeSample%28%29,-takeOrdered%28%29,-collect%28%29,-count%28%29,-countByValue%28%29,-reduce%28%29,-top%28%29" class="anchor-link">¶</a></h4>
<h4 id="Also-covered:">Also covered:<a href="#Also-covered:" class="anchor-link">¶</a></h4>
</li>
<li><h4 id="cache(),-unpersist(),-id(),-setName()"><code>cache()</code>, <code>unpersist()</code>, <code>id()</code>, <code>setName()</code><a href="#cache%28%29,-unpersist%28%29,-id%28%29,-setName%28%29" class="anchor-link">¶</a></h4>
<h4 id="Note-that,-for-reference,-you-can-look-up-the-details-of-these-methods-in-Spark's-Python-API">Note that, for reference, you can look up the details of these methods in <a target="_blank" href="https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD">Spark's Python API</a><a href="#Note-that,-for-reference,-you-can-look-up-the-details-of-these-methods-in-Spark%27s-Python-API" class="anchor-link">¶</a></h4>
</li>
</ul>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 52px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 22.025px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">**Part 1: Basic notebook usage and </span><span class="cm-strong cm-link cm-header cm-header-3">[Python]</span><span class="cm-string">(https://docs.python.org/2/)</span><span class="cm-strong cm-header cm-header-3"> integration **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 52px;"></div><div style="display: none; height: 82px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="Part-1:-Basic-notebook-usage-and-Python-integration-"><strong>Part 1: Basic notebook usage and <a target="_blank" href="https://docs.python.org/2/">Python</a> integration </strong><a href="#Part-1:-Basic-notebook-usage-and-Python-integration-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 229px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(1a) Notebook usage**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### A notebook is comprised of a linear sequence of cells.  These cells can contain either markdown or code, but we won't mix both in one cell.  When a markdown cell is executed it renders formatted text, images, and links just like HTML in a normal webpage.  The text you are reading right now is part of a markdown cell.  Python code cells allow you to execute arbitrary Python commands just like in any Python shell. Place your cursor inside the cell below, and press "Shift" + "Enter" to execute the code and advance to the next cell.  You can also press "Ctrl" + "Enter" to execute the code and remain in the cell.  These commands work the same in both markdown and code cells.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 229px;"></div><div style="display: none; height: 259px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(1a)-Notebook-usage"><strong>(1a) Notebook usage</strong><a href="#%281a%29-Notebook-usage" class="anchor-link">¶</a></h4>
<h4 id="A-notebook-is-comprised-of-a-linear-sequence-of-cells.--These-cells-can-contain-either-markdown-or-code,-but-we-won't-mix-both-in-one-cell.--When-a-markdown-cell-is-executed-it-renders-formatted-text,-images,-and-links-just-like-HTML-in-a-normal-webpage.--The-text-you-are-reading-right-now-is-part-of-a-markdown-cell.--Python-code-cells-allow-you-to-execute-arbitrary-Python-commands-just-like-in-any-Python-shell.-Place-your-cursor-inside-the-cell-below,-and-press-&quot;Shift&quot;-+-&quot;Enter&quot;-to-execute-the-code-and-advance-to-the-next-cell.--You-can-also-press-&quot;Ctrl&quot;-+-&quot;Enter&quot;-to-execute-the-code-and-remain-in-the-cell.--These-commands-work-the-same-in-both-markdown-and-code-cells.">A
 notebook is comprised of a linear sequence of cells.  These cells can 
contain either markdown or code, but we won't mix both in one cell.  
When a markdown cell is executed it renders formatted text, images, and 
links just like HTML in a normal webpage.  The text you are reading 
right now is part of a markdown cell.  Python code cells allow you to 
execute arbitrary Python commands just like in any Python shell. Place 
your cursor inside the cell below, and press "Shift" + "Enter" to 
execute the code and advance to the next cell.  You can also press 
"Ctrl" + "Enter" to execute the code and remain in the cell.  These 
commands work the same in both markdown and code cells.<a href="#A-notebook-is-comprised-of-a-linear-sequence-of-cells.--These-cells-can-contain-either-markdown-or-code,-but-we-won%27t-mix-both-in-one-cell.--When-a-markdown-cell-is-executed-it-renders-formatted-text,-images,-and-links-just-like-HTML-in-a-normal-webpage.--The-text-you-are-reading-right-now-is-part-of-a-markdown-cell.--Python-code-cells-allow-you-to-execute-arbitrary-Python-commands-just-like-in-any-Python-shell.-Place-your-cursor-inside-the-cell-below,-and-press-%22Shift%22-+-%22Enter%22-to-execute-the-code-and-advance-to-the-next-cell.--You-can-also-press-%22Ctrl%22-+-%22Enter%22-to-execute-the-code-and-remain-in-the-cell.--These-commands-work-the-same-in-both-markdown-and-code-cells." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 64.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 532.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 58.8px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># This is a Python cell. You can run normal Python code here...</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">'The sum of 1 and 2 is {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-number">1</span><span class="cm-operator">+</span><span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The sum of 1 and 2 is 3
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 784.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Here is another Python cell, this time with a variable (x) declaration and an if statement:</span></span></pre><pre class=""><span><span class="cm-variable">x</span> = <span class="cm-number">42</span></span></pre><pre class=""><span><span class="cm-keyword">if</span> <span class="cm-variable">x</span> <span class="cm-operator">&gt;</span> <span class="cm-number">40</span>:</span></pre><pre class=""><span>    <span class="cm-keyword">print</span> (<span class="cm-string">'The sum of 1 and 3 is {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-number">1</span><span class="cm-operator">+</span><span class="cm-number">3</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>The sum of 1 and 3 is 4
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 189px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(1b) Notebook state**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### As you work through a notebook it is important that you run all of the code cells.  The notebook is stateful, which means that variables and their values are retained until the notebook is detached (in Databricks Cloud) or the kernel is restarted (in IPython notebooks).  If you do not run all of the code cells as you proceed through the notebook, your variables will not be properly initialized and later code might fail.  You will also need to rerun any cells that you have modified in order for the changes to be available to other cells.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 189px;"></div><div style="display: none; height: 219px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(1b)-Notebook-state"><strong>(1b) Notebook state</strong><a href="#%281b%29-Notebook-state" class="anchor-link">¶</a></h4>
<h4 id="As-you-work-through-a-notebook-it-is-important-that-you-run-all-of-the-code-cells.--The-notebook-is-stateful,-which-means-that-variables-and-their-values-are-retained-until-the-notebook-is-detached-(in-Databricks-Cloud)-or-the-kernel-is-restarted-(in-IPython-notebooks).--If-you-do-not-run-all-of-the-code-cells-as-you-proceed-through-the-notebook,-your-variables-will-not-be-properly-initialized-and-later-code-might-fail.--You-will-also-need-to-rerun-any-cells-that-you-have-modified-in-order-for-the-changes-to-be-available-to-other-cells.">As
 you work through a notebook it is important that you run all of the 
code cells.  The notebook is stateful, which means that variables and 
their values are retained until the notebook is detached (in Databricks 
Cloud) or the kernel is restarted (in IPython notebooks).  If you do not
 run all of the code cells as you proceed through the notebook, your 
variables will not be properly initialized and later code might fail.  
You will also need to rerun any cells that you have modified in order 
for the changes to be available to other cells.<a href="#As-you-work-through-a-notebook-it-is-important-that-you-run-all-of-the-code-cells.--The-notebook-is-stateful,-which-means-that-variables-and-their-values-are-retained-until-the-notebook-is-detached-%28in-Databricks-Cloud%29-or-the-kernel-is-restarted-%28in-IPython-notebooks%29.--If-you-do-not-run-all-of-the-code-cells-as-you-proceed-through-the-notebook,-your-variables-will-not-be-properly-initialized-and-later-code-might-fail.--You-will-also-need-to-rerun-any-cells-that-you-have-modified-in-order-for-the-changes-to-be-available-to-other-cells." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 549px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment">#from __future__ import print_function #python3 print</span></span></pre><pre class=""><span><span class="cm-comment"># This cell relies on x being defined already.</span></span></pre><pre class=""><span><span class="cm-comment"># If we didn't run the cells from part (1a) this code would fail.</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">x</span> <span class="cm-operator">*</span> <span class="cm-number">2</span></span></pre><pre class=""><span><span class="cm-keyword">print</span>(<span class="cm-string">"x="</span>,<span class="cm-variable">x</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 96px;"></div><div style="display: none; height: 126px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>84
('x=', 42)
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 110px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(1c) Library imports**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### We can import standard Python libraries (</span><span class="cm-link cm-header cm-header-4">[modules]</span><span class="cm-string">(https://docs.python.org/2/tutorial/modules.html)</span><span class="cm-header cm-header-4">) the usual way.  An </span><span class="cm-comment cm-header cm-header-4">`import`</span><span class="cm-header cm-header-4"> statement will import the specified module.  In this tutorial and future labs, we will provide any imports that are necessary.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 110px;"></div><div style="display: none; height: 140px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(1c)-Library-imports"><strong>(1c) Library imports</strong><a href="#%281c%29-Library-imports" class="anchor-link">¶</a></h4>
<h4 id="We-can-import-standard-Python-libraries-(modules)-the-usual-way.--An-import-statement-will-import-the-specified-module.--In-this-tutorial-and-future-labs,-we-will-provide-any-imports-that-are-necessary.">We can import standard Python libraries (<a target="_blank" href="https://docs.python.org/2/tutorial/modules.html">modules</a>) the usual way.  An <code>import</code> statement will import the specified module.  In this tutorial and future labs, we will provide any imports that are necessary.<a href="#We-can-import-standard-Python-libraries-%28modules%29-the-usual-way.--An-import-statement-will-import-the-specified-module.--In-this-tutorial-and-future-labs,-we-will-provide-any-imports-that-are-necessary." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 330.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Import the regular expression library</span></span></pre><pre class=""><span><span class="cm-keyword">import</span> <span class="cm-variable">re</span></span></pre><pre class=""><span><span class="cm-variable">m</span> = <span class="cm-variable">re</span>.<span class="cm-variable">search</span>(<span class="cm-string">'(?&lt;=abc)def'</span>, <span class="cm-string">'abcdef'</span>)</span></pre><pre class=""><span><span class="cm-variable">m</span>.<span class="cm-variable">group</span>(<span class="cm-number">0</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[6]:</div><div class="output_subarea output_text output_result"><pre>'def'</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 565.8px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Import the datetime library</span></span></pre><pre class=""><span><span class="cm-keyword">import</span> <span class="cm-variable">datetime</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> (<span class="cm-string">'This was last run on: {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">datetime</span>.<span class="cm-variable">datetime</span>.<span class="cm-variable">now</span>()))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>This was last run on: 2015-06-14 15:14:31.181735
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 93px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 22.0249px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">###  </span><span class="cm-strong cm-header cm-header-3">**Part 2: An introduction to using </span><span class="cm-strong cm-link cm-header cm-header-3">[Apache Spark]</span><span class="cm-string">(https://spark.apache.org/)</span><span class="cm-strong cm-header cm-header-3"> with the Python </span><span class="cm-strong cm-link cm-header cm-header-3">[pySpark API]</span><span class="cm-string">(https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)</span><span class="cm-strong cm-header cm-header-3"> running in the browser**</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 93px;"></div><div style="display: none; height: 123px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="Part-2:-An-introduction-to-using-Apache-Spark-with-the-Python-pySpark-API-running-in-the-browser"><strong>Part 2: An introduction to using <a target="_blank" href="https://spark.apache.org/">Apache Spark</a> with the Python <a target="_blank" href="https://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD">pySpark API</a> running in the browser</strong><a href="#Part-2:-An-introduction-to-using-Apache-Spark-with-the-Python-pySpark-API-running-in-the-browser" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 427px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**Spark Context**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In Spark, communication occurs between a driver and executors.  The driver has Spark jobs that it needs to run and these jobs are split into tasks that are submitted to the executors for completion.  The results from these tasks are delivered back to the driver.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In part 1, we saw that normal python code can be executed via cells. When using Databricks Cloud this code gets executed in the Spark driver's Java Virtual Machine (JVM) and not in an executor's JVM, and when using an IPython notebook it is executed within the kernel associated with the notebook. Since no Spark functionality is actually being used, no tasks are launched on the executors.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In order to use Spark and its API we will need to use a </span><span class="cm-comment cm-header cm-header-4">`SparkContext`</span><span class="cm-header cm-header-4">.  When running Spark, you start a new Spark application by creating a </span><span class="cm-link cm-header cm-header-4">[SparkContext]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.SparkContext)</span><span class="cm-header cm-header-4">.  When the </span><span class="cm-comment cm-header cm-header-4">`SparkContext`</span><span class="cm-header cm-header-4"> is created, it asks the master for some cores to use to do work.  The master sets these cores aside just for you; they won't be used for other applications. When using Databricks Cloud or the virtual machine provisioned for this class, the </span><span class="cm-comment cm-header cm-header-4">`SparkContext`</span><span class="cm-header cm-header-4"> is created for you automatically as </span><span class="cm-comment cm-header cm-header-4">`sc`</span><span class="cm-header cm-header-4">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 427px;"></div><div style="display: none; height: 457px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="Spark-Context"><strong>Spark Context</strong><a href="#Spark-Context" class="anchor-link">¶</a></h4>
<h4 id="In-Spark,-communication-occurs-between-a-driver-and-executors.--The-driver-has-Spark-jobs-that-it-needs-to-run-and-these-jobs-are-split-into-tasks-that-are-submitted-to-the-executors-for-completion.--The-results-from-these-tasks-are-delivered-back-to-the-driver.">In
 Spark, communication occurs between a driver and executors.  The driver
 has Spark jobs that it needs to run and these jobs are split into tasks
 that are submitted to the executors for completion.  The results from 
these tasks are delivered back to the driver.<a href="#In-Spark,-communication-occurs-between-a-driver-and-executors.--The-driver-has-Spark-jobs-that-it-needs-to-run-and-these-jobs-are-split-into-tasks-that-are-submitted-to-the-executors-for-completion.--The-results-from-these-tasks-are-delivered-back-to-the-driver." class="anchor-link">¶</a></h4>
<h4 id="In-part-1,-we-saw-that-normal-python-code-can-be-executed-via-cells.-When-using-Databricks-Cloud-this-code-gets-executed-in-the-Spark-driver's-Java-Virtual-Machine-(JVM)-and-not-in-an-executor's-JVM,-and-when-using-an-IPython-notebook-it-is-executed-within-the-kernel-associated-with-the-notebook.-Since-no-Spark-functionality-is-actually-being-used,-no-tasks-are-launched-on-the-executors.">In
 part 1, we saw that normal python code can be executed via cells. When 
using Databricks Cloud this code gets executed in the Spark driver's 
Java Virtual Machine (JVM) and not in an executor's JVM, and when using 
an IPython notebook it is executed within the kernel associated with the
 notebook. Since no Spark functionality is actually being used, no tasks
 are launched on the executors.<a href="#In-part-1,-we-saw-that-normal-python-code-can-be-executed-via-cells.-When-using-Databricks-Cloud-this-code-gets-executed-in-the-Spark-driver%27s-Java-Virtual-Machine-%28JVM%29-and-not-in-an-executor%27s-JVM,-and-when-using-an-IPython-notebook-it-is-executed-within-the-kernel-associated-with-the-notebook.-Since-no-Spark-functionality-is-actually-being-used,-no-tasks-are-launched-on-the-executors." class="anchor-link">¶</a></h4>
<h4 id="In-order-to-use-Spark-and-its-API-we-will-need-to-use-a-SparkContext.--When-running-Spark,-you-start-a-new-Spark-application-by-creating-a-SparkContext.--When-the-SparkContext-is-created,-it-asks-the-master-for-some-cores-to-use-to-do-work.--The-master-sets-these-cores-aside-just-for-you;-they-won't-be-used-for-other-applications.-When-using-Databricks-Cloud-or-the-virtual-machine-provisioned-for-this-class,-the-SparkContext-is-created-for-you-automatically-as-sc.">In order to use Spark and its API we will need to use a <code>SparkContext</code>.  When running Spark, you start a new Spark application by creating a <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.SparkContext">SparkContext</a>.  When the <code>SparkContext</code>
 is created, it asks the master for some cores to use to do work.  The 
master sets these cores aside just for you; they won't be used for other
 applications. When using Databricks Cloud or the virtual machine 
provisioned for this class, the <code>SparkContext</code> is created for you automatically as <code>sc</code>.<a href="#In-order-to-use-Spark-and-its-API-we-will-need-to-use-a-SparkContext.--When-running-Spark,-you-start-a-new-Spark-application-by-creating-a-SparkContext.--When-the-SparkContext-is-created,-it-asks-the-master-for-some-cores-to-use-to-do-work.--The-master-sets-these-cores-aside-just-for-you;-they-won%27t-be-used-for-other-applications.-When-using-Databricks-Cloud-or-the-virtual-machine-provisioned-for-this-class,-the-SparkContext-is-created-for-you-automatically-as-sc." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 540px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(2a) Example Cluster**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The diagram below shows an example cluster, where the cores allocated for an application are outlined in purple.</span></span></pre><pre class=""><span><span class="cm-tag">![executors]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/executors.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### You can view the details of your Spark application in the Spark web UI.  The web UI is accessible in Databricks cloud by going to "Clusters" and then clicking on the "View Spark UI" link for your cluster.  When running locally you'll find it at </span><span class="cm-link cm-header cm-header-4">[</span><span class="cm-link cm-header cm-header-4 cm-link">localhost:4040]</span><span class="cm-string cm-link">(http://localhost:4040)</span><span class="cm-header cm-header-4">.  In the web UI, under the "Jobs" tab, you can see a list of jobs that have been scheduled or run.  It's likely there isn't any thing interesting here yet because we haven't run any jobs, but we'll return to this page later.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### At a high level, every Spark application consists of a driver program that launches various parallel operations on executor Java Virtual Machines (JVMs) running either in a cluster or locally on the same machine. In Databricks Cloud, "Databricks Shell" is the driver program.  When running locally, "PySparkShell" is the driver program. In all cases, this driver program contains the main loop for the program and creates distributed datasets on the cluster, then applies operations (transformations &amp; actions) to those datasets.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Driver programs access Spark through a SparkContext object, which represents a connection to a computing cluster. A Spark context object (</span><span class="cm-comment cm-header cm-header-4">`sc`</span><span class="cm-header cm-header-4">) is the main entry point for Spark functionality. A Spark context can be used to create Resilient Distributed Datasets (RDDs) on a cluster.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Try printing out </span><span class="cm-comment cm-header cm-header-4">`sc`</span><span class="cm-header cm-header-4"> to see its type.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 540px;"></div><div style="display: none; height: 570px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(2a)-Example-Cluster"><strong>(2a) Example Cluster</strong><a href="#%282a%29-Example-Cluster" class="anchor-link">¶</a></h4>
<h4 id="The-diagram-below-shows-an-example-cluster,-where-the-cores-allocated-for-an-application-are-outlined-in-purple.">The diagram below shows an example cluster, where the cores allocated for an application are outlined in purple.<a href="#The-diagram-below-shows-an-example-cluster,-where-the-cores-allocated-for-an-application-are-outlined-in-purple." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/executors.png" alt="executors"></p>
<h4 id="You-can-view-the-details-of-your-Spark-application-in-the-Spark-web-UI.--The-web-UI-is-accessible-in-Databricks-cloud-by-going-to-&quot;Clusters&quot;-and-then-clicking-on-the-&quot;View-Spark-UI&quot;-link-for-your-cluster.--When-running-locally-you'll-find-it-at-localhost:4040.--In-the-web-UI,-under-the-&quot;Jobs&quot;-tab,-you-can-see-a-list-of-jobs-that-have-been-scheduled-or-run.--It's-likely-there-isn't-any-thing-interesting-here-yet-because-we-haven't-run-any-jobs,-but-we'll-return-to-this-page-later.">You
 can view the details of your Spark application in the Spark web UI.  
The web UI is accessible in Databricks cloud by going to "Clusters" and 
then clicking on the "View Spark UI" link for your cluster.  When 
running locally you'll find it at <a target="_blank" href="http://localhost:4040/">localhost:4040</a>.
  In the web UI, under the "Jobs" tab, you can see a list of jobs that 
have been scheduled or run.  It's likely there isn't any thing 
interesting here yet because we haven't run any jobs, but we'll return 
to this page later.<a href="#You-can-view-the-details-of-your-Spark-application-in-the-Spark-web-UI.--The-web-UI-is-accessible-in-Databricks-cloud-by-going-to-%22Clusters%22-and-then-clicking-on-the-%22View-Spark-UI%22-link-for-your-cluster.--When-running-locally-you%27ll-find-it-at-localhost:4040.--In-the-web-UI,-under-the-%22Jobs%22-tab,-you-can-see-a-list-of-jobs-that-have-been-scheduled-or-run.--It%27s-likely-there-isn%27t-any-thing-interesting-here-yet-because-we-haven%27t-run-any-jobs,-but-we%27ll-return-to-this-page-later." class="anchor-link">¶</a></h4>
<h4 id="At-a-high-level,-every-Spark-application-consists-of-a-driver-program-that-launches-various-parallel-operations-on-executor-Java-Virtual-Machines-(JVMs)-running-either-in-a-cluster-or-locally-on-the-same-machine.-In-Databricks-Cloud,-&quot;Databricks-Shell&quot;-is-the-driver-program.--When-running-locally,-&quot;PySparkShell&quot;-is-the-driver-program.-In-all-cases,-this-driver-program-contains-the-main-loop-for-the-program-and-creates-distributed-datasets-on-the-cluster,-then-applies-operations-(transformations-&amp;-actions)-to-those-datasets.">At
 a high level, every Spark application consists of a driver program that
 launches various parallel operations on executor Java Virtual Machines 
(JVMs) running either in a cluster or locally on the same machine. In 
Databricks Cloud, "Databricks Shell" is the driver program.  When 
running locally, "PySparkShell" is the driver program. In all cases, 
this driver program contains the main loop for the program and creates 
distributed datasets on the cluster, then applies operations 
(transformations &amp; actions) to those datasets.<a href="#At-a-high-level,-every-Spark-application-consists-of-a-driver-program-that-launches-various-parallel-operations-on-executor-Java-Virtual-Machines-%28JVMs%29-running-either-in-a-cluster-or-locally-on-the-same-machine.-In-Databricks-Cloud,-%22Databricks-Shell%22-is-the-driver-program.--When-running-locally,-%22PySparkShell%22-is-the-driver-program.-In-all-cases,-this-driver-program-contains-the-main-loop-for-the-program-and-creates-distributed-datasets-on-the-cluster,-then-applies-operations-%28transformations-&amp;-actions%29-to-those-datasets." class="anchor-link">¶</a></h4>
<h4 id="Driver-programs-access-Spark-through-a-SparkContext-object,-which-represents-a-connection-to-a-computing-cluster.-A-Spark-context-object-(sc)-is-the-main-entry-point-for-Spark-functionality.-A-Spark-context-can-be-used-to-create-Resilient-Distributed-Datasets-(RDDs)-on-a-cluster.">Driver
 programs access Spark through a SparkContext object, which represents a
 connection to a computing cluster. A Spark context object (<code>sc</code>)
 is the main entry point for Spark functionality. A Spark context can be
 used to create Resilient Distributed Datasets (RDDs) on a cluster.<a href="#Driver-programs-access-Spark-through-a-SparkContext-object,-which-represents-a-connection-to-a-computing-cluster.-A-Spark-context-object-%28sc%29-is-the-main-entry-point-for-Spark-functionality.-A-Spark-context-can-be-used-to-create-Resilient-Distributed-Datasets-%28RDDs%29-on-a-cluster." class="anchor-link">¶</a></h4>
<h4 id="Try-printing-out-sc-to-see-its-type.">Try printing out <code>sc</code> to see its type.<a href="#Try-printing-out-sc-to-see-its-type." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 355.8px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Display the type of the Spark Context sc</span></span></pre><pre class=""><span><span class="cm-builtin">type</span>(<span class="cm-variable">sc</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[8]:</div><div class="output_subarea output_text output_result"><pre>pyspark.context.SparkContext</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 90px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(2b) </span><span class="cm-strong cm-comment cm-header cm-header-4">`SparkContext`</span><span class="cm-strong cm-header cm-header-4"> attributes**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### You can use Python's </span><span class="cm-link cm-header cm-header-4">[dir()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=dir#dir)</span><span class="cm-header cm-header-4"> function to get a list of all the attributes (including methods) accessible through the </span><span class="cm-comment cm-header cm-header-4">`sc`</span><span class="cm-header cm-header-4"> object.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 90px;"></div><div style="display: none; height: 120px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(2b)-SparkContext-attributes"><strong>(2b) <code>SparkContext</code> attributes</strong><a href="#%282b%29-SparkContext-attributes" class="anchor-link">¶</a></h4>
<h4 id="You-can-use-Python's-dir()-function-to-get-a-list-of-all-the-attributes-(including-methods)-accessible-through-the-sc-object.">You can use Python's <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=dir#dir">dir()</a> function to get a list of all the attributes (including methods) accessible through the <code>sc</code> object.<a href="#You-can-use-Python%27s-dir%28%29-function-to-get-a-list-of-all-the-attributes-%28including-methods%29-accessible-through-the-sc-object." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[48]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5996px; left: 14px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">#</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 187.8px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 8.39999px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># List sc's attributes</span></span></pre><pre><span><span class="cm-comment">#dir(sc)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell unrendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 46.5991px; left: 738.033px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 71px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 732.433px; top: 40.9995px; height: 18.4005px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(2c) Getting help**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Alternatively, you can use Python's </span><span class="cm-link cm-header cm-header-4">[help()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=help#help)</span><span class="cm-header cm-header-4"> function to get an easier to read list of all the attributes, including examples, that the </span><span class="cm-comment cm-header cm-header-4">`sc`</span><span class="cm-header cm-header-4"> object has.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 71px;"></div><div style="display: none; height: 120px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(2c)-Getting-help"><strong>(2c) Getting help</strong><a href="#%282c%29-Getting-help" class="anchor-link">¶</a></h4>
<h4 id="Alternatively,-you-can-use-Python's-help()-function-to-get-an-easier-to-read-list-of-all-the-attributes,-including-examples,-that-the-sc-object-has.">Alternatively, you can use Python's <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=help#help">help()</a> function to get an easier to read list of all the attributes, including examples, that the <code>sc</code> object has.<a href="#Alternatively,-you-can-use-Python%27s-help%28%29-function-to-get-an-easier-to-read-list-of-all-the-attributes,-including-examples,-that-the-sc-object-has." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell unrendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[20]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5996px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 389.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 0px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Use help to obtain more detailed information</span></span></pre><pre class=""><span><span class="cm-comment">#help(sc)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[21]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 910.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># After reading the help we've decided we want to use sc.version to see what version of Spark we are running</span></span></pre><pre class=""><span><span class="cm-variable">sc</span>.<span class="cm-variable">version</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[21]:</div><div class="output_subarea output_text output_result"><pre>u'1.3.1'</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[22]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5996px; left: 14px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">#</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 330.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 8.39999px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Help can be used on any Python object</span></span></pre><pre class=""><span><span class="cm-comment">#help(map)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 52px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 22.0249px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">**Part 3: Using RDDs and chaining together transformations and actions**</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 52px;"></div><div style="display: none; height: 82px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="Part-3:-Using-RDDs-and-chaining-together-transformations-and-actions"><strong>Part 3: Using RDDs and chaining together transformations and actions</strong><a href="#Part-3:-Using-RDDs-and-chaining-together-transformations-and-actions" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 396px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**Working with your first RDD**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In Spark, we first create a base </span><span class="cm-link cm-header cm-header-4">[Resilient Distributed Dataset]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)</span><span class="cm-header cm-header-4"> (RDD). We can then apply one or more transformations to that base RDD. </span><span class="cm-em cm-header cm-header-4">*An RDD is immutable, so once it is created, it cannot be changed.*</span><span class="cm-header cm-header-4"> As a result, each transformation creates a new RDD. Finally, we can apply one or more actions to the RDDs.  Note that Spark uses lazy evaluation, so transformations are not actually executed until an action occurs.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### We will perform several exercises to obtain a better understanding of RDDs:</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Create a Python collection of 10,000 integers</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Create a Spark base RDD from that collection</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Subtract one from each value using </span><span class="cm-comment cm-variable-2">`map`</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Perform action </span><span class="cm-comment cm-variable-2">`collect`</span><span class="cm-variable-2"> to view results</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Perform action </span><span class="cm-comment cm-variable-2">`count`</span><span class="cm-variable-2"> to view counts</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Apply transformation </span><span class="cm-comment cm-variable-2">`filter`</span><span class="cm-variable-2"> and view results with </span><span class="cm-comment cm-variable-2">`collect`</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Learn about lambda functions</span></span></pre><pre class=""><span><span class="cm-variable-2">* ##### Explore how lazy evaluation works and the debugging challenges that it introduces</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 396px;"></div><div style="display: none; height: 426px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="Working-with-your-first-RDD"><strong>Working with your first RDD</strong><a href="#Working-with-your-first-RDD" class="anchor-link">¶</a></h4>
<h4 id="In-Spark,-we-first-create-a-base-Resilient-Distributed-Dataset-(RDD).-We-can-then-apply-one-or-more-transformations-to-that-base-RDD.-An-RDD-is-immutable,-so-once-it-is-created,-it-cannot-be-changed.-As-a-result,-each-transformation-creates-a-new-RDD.-Finally,-we-can-apply-one-or-more-actions-to-the-RDDs.--Note-that-Spark-uses-lazy-evaluation,-so-transformations-are-not-actually-executed-until-an-action-occurs.">In Spark, we first create a base <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD">Resilient Distributed Dataset</a> (RDD). We can then apply one or more transformations to that base RDD. <em>An RDD is immutable, so once it is created, it cannot be changed.</em>
 As a result, each transformation creates a new RDD. Finally, we can 
apply one or more actions to the RDDs.  Note that Spark uses lazy 
evaluation, so transformations are not actually executed until an action
 occurs.<a href="#In-Spark,-we-first-create-a-base-Resilient-Distributed-Dataset-%28RDD%29.-We-can-then-apply-one-or-more-transformations-to-that-base-RDD.-An-RDD-is-immutable,-so-once-it-is-created,-it-cannot-be-changed.-As-a-result,-each-transformation-creates-a-new-RDD.-Finally,-we-can-apply-one-or-more-actions-to-the-RDDs.--Note-that-Spark-uses-lazy-evaluation,-so-transformations-are-not-actually-executed-until-an-action-occurs." class="anchor-link">¶</a></h4>
<h4 id="We-will-perform-several-exercises-to-obtain-a-better-understanding-of-RDDs:">We will perform several exercises to obtain a better understanding of RDDs:<a href="#We-will-perform-several-exercises-to-obtain-a-better-understanding-of-RDDs:" class="anchor-link">¶</a></h4>
<ul>
<li><h5 id="Create-a-Python-collection-of-10,000-integers">Create a Python collection of 10,000 integers<a href="#Create-a-Python-collection-of-10,000-integers" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Create-a-Spark-base-RDD-from-that-collection">Create a Spark base RDD from that collection<a href="#Create-a-Spark-base-RDD-from-that-collection" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Subtract-one-from-each-value-using-map">Subtract one from each value using <code>map</code><a href="#Subtract-one-from-each-value-using-map" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Perform-action-collect-to-view-results">Perform action <code>collect</code> to view results<a href="#Perform-action-collect-to-view-results" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Perform-action-count-to-view-counts">Perform action <code>count</code> to view counts<a href="#Perform-action-count-to-view-counts" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Apply-transformation-filter-and-view-results-with-collect">Apply transformation <code>filter</code> and view results with <code>collect</code><a href="#Apply-transformation-filter-and-view-results-with-collect" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Learn-about-lambda-functions">Learn about lambda functions<a href="#Learn-about-lambda-functions" class="anchor-link">¶</a></h5>
</li>
<li><h5 id="Explore-how-lazy-evaluation-works-and-the-debugging-challenges-that-it-introduces">Explore how lazy evaluation works and the debugging challenges that it introduces<a href="#Explore-how-lazy-evaluation-works-and-the-debugging-challenges-that-it-introduces" class="anchor-link">¶</a></h5>
</li>
</ul>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 229px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 21.2px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(3a) Create a Python collection of integers in the range of 1 .. 10000**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### We will use the </span><span class="cm-link cm-header cm-header-4">[xrange()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=xrange#xrange)</span><span class="cm-header cm-header-4"> function to create a </span><span class="cm-link cm-header cm-header-4">[list()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=list#list)</span><span class="cm-header cm-header-4"> of integers.  </span><span class="cm-comment cm-header cm-header-4">`xrange()`</span><span class="cm-header cm-header-4"> only generates values as they are needed.  This is different from the behavior of </span><span class="cm-link cm-header cm-header-4">[range()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=range#range)</span><span class="cm-header cm-header-4"> which generates the complete list upon execution.  Because of this </span><span class="cm-comment cm-header cm-header-4">`xrange()`</span><span class="cm-header cm-header-4"> is more memory efficient than </span><span class="cm-comment cm-header cm-header-4">`range()`</span><span class="cm-header cm-header-4">, especially for large ranges.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 229px;"></div><div style="display: none; height: 259px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(3a)-Create-a-Python-collection-of-integers-in-the-range-of-1-..-10000"><strong>(3a) Create a Python collection of integers in the range of 1 .. 10000</strong><a href="#%283a%29-Create-a-Python-collection-of-integers-in-the-range-of-1-..-10000" class="anchor-link">¶</a></h4>
<h4 id="We-will-use-the-xrange()-function-to-create-a-list()-of-integers.--xrange()-only-generates-values-as-they-are-needed.--This-is-different-from-the-behavior-of-range()-which-generates-the-complete-list-upon-execution.--Because-of-this-xrange()-is-more-memory-efficient-than-range(),-especially-for-large-ranges.">We will use the <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=xrange#xrange">xrange()</a> function to create a <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=list#list">list()</a> of integers.  <code>xrange()</code> only generates values as they are needed.  This is different from the behavior of <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=range#range">range()</a> which generates the complete list upon execution.  Because of this <code>xrange()</code> is more memory efficient than <code>range()</code>, especially for large ranges.<a href="#We-will-use-the-xrange%28%29-function-to-create-a-list%28%29-of-integers.--xrange%28%29-only-generates-values-as-they-are-needed.--This-is-different-from-the-behavior-of-range%28%29-which-generates-the-complete-list-upon-execution.--Because-of-this-xrange%28%29-is-more-memory-efficient-than-range%28%29,-especially-for-large-ranges." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[16]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6016px; left: 291.2px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 288.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 285.6px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-variable">data</span> = <span class="cm-builtin">xrange</span>(<span class="cm-number">1</span>, <span class="cm-number">10001</span>) </span></pre><pre class=""><span><span class="cm-comment"># data = range(1, 10001) # python3</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[25]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5996px; left: 56px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">0</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 297px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 50.4px; top: 34px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Data is just a normal Python list</span></span></pre><pre class=""><span><span class="cm-comment"># Obtain data's first element</span></span></pre><pre><span><span class="cm-variable">data</span>[<span class="cm-number">0</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[25]:</div><div class="output_subarea output_text output_result"><pre>1</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[18]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 507px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># We can check the size of the list using the len() function</span></span></pre><pre class=""><span><span class="cm-builtin">len</span>(<span class="cm-variable">data</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[18]:</div><div class="output_subarea output_text output_result"><pre>10000</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 738px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(3b) Distributed data and using a collection to create an RDD**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In Spark, datasets are represented as a list of entries, where the list is broken up into many different partitions that are each stored on a different machine.  Each partition holds a unique subset of the entries in the list.  Spark calls datasets that it stores "Resilient Distributed Datasets" (RDDs).</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### One of the defining features of Spark, compared to other data analytics frameworks (e.g., Hadoop), is that it stores data in memory rather than on disk.  This allows Spark applications to run much more quickly, because they are not slowed down by needing to read data from disk.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The figure below illustrates how Spark breaks a list of data entries into partitions that are each stored in memory on a worker.</span></span></pre><pre class=""><span><span class="cm-tag">![partitions]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/partitions.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To create the RDD, we use </span><span class="cm-comment cm-header cm-header-4">`sc.parallelize()`</span><span class="cm-header cm-header-4">, which tells Spark to create a new set of input data based on data that is passed in.  In this example, we will provide an </span><span class="cm-comment cm-header cm-header-4">`xrange`</span><span class="cm-header cm-header-4">.  The second argument to the </span><span class="cm-link cm-header cm-header-4">[sc.parallelize()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.SparkContext.parallelize)</span><span class="cm-header cm-header-4"> method tells Spark how many partitions to break the data into when it stores the data in memory (we'll talk more about this later in this tutorial). Note that for better performance when using </span><span class="cm-comment cm-header cm-header-4">`parallelize`</span><span class="cm-header cm-header-4">, </span><span class="cm-comment cm-header cm-header-4">`xrange()`</span><span class="cm-header cm-header-4"> is recommended if the input represents a range. This is the reason why we used </span><span class="cm-comment cm-header cm-header-4">`xrange()`</span><span class="cm-header cm-header-4"> in 3a.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### There are many different types of RDDs.  The base class for RDDs is </span><span class="cm-link cm-header cm-header-4">[pyspark.RDD]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD)</span><span class="cm-header cm-header-4"> and other RDDs subclass </span><span class="cm-comment cm-header cm-header-4">`pyspark.RDD`</span><span class="cm-header cm-header-4">.  Since the other RDD types inherit from </span><span class="cm-comment cm-header cm-header-4">`pyspark.RDD`</span><span class="cm-header cm-header-4"> they have the same APIs and are functionally identical.  We'll see that </span><span class="cm-comment cm-header cm-header-4">`sc.parallelize()`</span><span class="cm-header cm-header-4"> generates a </span><span class="cm-comment cm-header cm-header-4">`pyspark.rdd.PipelinedRDD`</span><span class="cm-header cm-header-4"> when its input is an </span><span class="cm-comment cm-header cm-header-4">`xrange`</span><span class="cm-header cm-header-4">, and a </span><span class="cm-comment cm-header cm-header-4">`pyspark.RDD`</span><span class="cm-header cm-header-4"> when its input is a </span><span class="cm-comment cm-header cm-header-4">`range`</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### After we generate RDDs, we can view them in the "Storage" tab of the web UI.  You'll notice that new datasets are not listed until Spark needs to return a result due to an action being executed.  This feature of Spark is called "lazy evaluation".  This allows Spark to avoid performing unnecessary calculations.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 738px;"></div><div style="display: none; height: 768px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(3b)-Distributed-data-and-using-a-collection-to-create-an-RDD"><strong>(3b) Distributed data and using a collection to create an RDD</strong><a href="#%283b%29-Distributed-data-and-using-a-collection-to-create-an-RDD" class="anchor-link">¶</a></h4>
<h4 id="In-Spark,-datasets-are-represented-as-a-list-of-entries,-where-the-list-is-broken-up-into-many-different-partitions-that-are-each-stored-on-a-different-machine.--Each-partition-holds-a-unique-subset-of-the-entries-in-the-list.--Spark-calls-datasets-that-it-stores-&quot;Resilient-Distributed-Datasets&quot;-(RDDs).">In
 Spark, datasets are represented as a list of entries, where the list is
 broken up into many different partitions that are each stored on a 
different machine.  Each partition holds a unique subset of the entries 
in the list.  Spark calls datasets that it stores "Resilient Distributed
 Datasets" (RDDs).<a href="#In-Spark,-datasets-are-represented-as-a-list-of-entries,-where-the-list-is-broken-up-into-many-different-partitions-that-are-each-stored-on-a-different-machine.--Each-partition-holds-a-unique-subset-of-the-entries-in-the-list.--Spark-calls-datasets-that-it-stores-%22Resilient-Distributed-Datasets%22-%28RDDs%29." class="anchor-link">¶</a></h4>
<h4 id="One-of-the-defining-features-of-Spark,-compared-to-other-data-analytics-frameworks-(e.g.,-Hadoop),-is-that-it-stores-data-in-memory-rather-than-on-disk.--This-allows-Spark-applications-to-run-much-more-quickly,-because-they-are-not-slowed-down-by-needing-to-read-data-from-disk.">One
 of the defining features of Spark, compared to other data analytics 
frameworks (e.g., Hadoop), is that it stores data in memory rather than 
on disk.  This allows Spark applications to run much more quickly, 
because they are not slowed down by needing to read data from disk.<a href="#One-of-the-defining-features-of-Spark,-compared-to-other-data-analytics-frameworks-%28e.g.,-Hadoop%29,-is-that-it-stores-data-in-memory-rather-than-on-disk.--This-allows-Spark-applications-to-run-much-more-quickly,-because-they-are-not-slowed-down-by-needing-to-read-data-from-disk." class="anchor-link">¶</a></h4>
<h4 id="The-figure-below-illustrates-how-Spark-breaks-a-list-of-data-entries-into-partitions-that-are-each-stored-in-memory-on-a-worker.">The figure below illustrates how Spark breaks a list of data entries into partitions that are each stored in memory on a worker.<a href="#The-figure-below-illustrates-how-Spark-breaks-a-list-of-data-entries-into-partitions-that-are-each-stored-in-memory-on-a-worker." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/partitions.png" alt="partitions"></p>
<h4 id="To-create-the-RDD,-we-use-sc.parallelize(),-which-tells-Spark-to-create-a-new-set-of-input-data-based-on-data-that-is-passed-in.--In-this-example,-we-will-provide-an-xrange.--The-second-argument-to-the-sc.parallelize()-method-tells-Spark-how-many-partitions-to-break-the-data-into-when-it-stores-the-data-in-memory-(we'll-talk-more-about-this-later-in-this-tutorial).-Note-that-for-better-performance-when-using-parallelize,-xrange()-is-recommended-if-the-input-represents-a-range.-This-is-the-reason-why-we-used-xrange()-in-3a.">To create the RDD, we use <code>sc.parallelize()</code>, which tells Spark to create a new set of input data based on data that is passed in.  In this example, we will provide an <code>xrange</code>.  The second argument to the <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.SparkContext.parallelize">sc.parallelize()</a>
 method tells Spark how many partitions to break the data into when it 
stores the data in memory (we'll talk more about this later in this 
tutorial). Note that for better performance when using <code>parallelize</code>, <code>xrange()</code> is recommended if the input represents a range. This is the reason why we used <code>xrange()</code> in 3a.<a href="#To-create-the-RDD,-we-use-sc.parallelize%28%29,-which-tells-Spark-to-create-a-new-set-of-input-data-based-on-data-that-is-passed-in.--In-this-example,-we-will-provide-an-xrange.--The-second-argument-to-the-sc.parallelize%28%29-method-tells-Spark-how-many-partitions-to-break-the-data-into-when-it-stores-the-data-in-memory-%28we%27ll-talk-more-about-this-later-in-this-tutorial%29.-Note-that-for-better-performance-when-using-parallelize,-xrange%28%29-is-recommended-if-the-input-represents-a-range.-This-is-the-reason-why-we-used-xrange%28%29-in-3a." class="anchor-link">¶</a></h4>
<h4 id="There-are-many-different-types-of-RDDs.--The-base-class-for-RDDs-is-pyspark.RDD-and-other-RDDs-subclass-pyspark.RDD.--Since-the-other-RDD-types-inherit-from-pyspark.RDD-they-have-the-same-APIs-and-are-functionally-identical.--We'll-see-that-sc.parallelize()-generates-a-pyspark.rdd.PipelinedRDD-when-its-input-is-an-xrange,-and-a-pyspark.RDD-when-its-input-is-a-range.">There are many different types of RDDs.  The base class for RDDs is <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD">pyspark.RDD</a> and other RDDs subclass <code>pyspark.RDD</code>.  Since the other RDD types inherit from <code>pyspark.RDD</code> they have the same APIs and are functionally identical.  We'll see that <code>sc.parallelize()</code> generates a <code>pyspark.rdd.PipelinedRDD</code> when its input is an <code>xrange</code>, and a <code>pyspark.RDD</code> when its input is a <code>range</code>.<a href="#There-are-many-different-types-of-RDDs.--The-base-class-for-RDDs-is-pyspark.RDD-and-other-RDDs-subclass-pyspark.RDD.--Since-the-other-RDD-types-inherit-from-pyspark.RDD-they-have-the-same-APIs-and-are-functionally-identical.--We%27ll-see-that-sc.parallelize%28%29-generates-a-pyspark.rdd.PipelinedRDD-when-its-input-is-an-xrange,-and-a-pyspark.RDD-when-its-input-is-a-range." class="anchor-link">¶</a></h4>
<h4 id="After-we-generate-RDDs,-we-can-view-them-in-the-&quot;Storage&quot;-tab-of-the-web-UI.--You'll-notice-that-new-datasets-are-not-listed-until-Spark-needs-to-return-a-result-due-to-an-action-being-executed.--This-feature-of-Spark-is-called-&quot;lazy-evaluation&quot;.--This-allows-Spark-to-avoid-performing-unnecessary-calculations.">After
 we generate RDDs, we can view them in the "Storage" tab of the web UI. 
 You'll notice that new datasets are not listed until Spark needs to 
return a result due to an action being executed.  This feature of Spark 
is called "lazy evaluation".  This allows Spark to avoid performing 
unnecessary calculations.<a href="#After-we-generate-RDDs,-we-can-view-them-in-the-%22Storage%22-tab-of-the-web-UI.--You%27ll-notice-that-new-datasets-are-not-listed-until-Spark-needs-to-return-a-result-due-to-an-action-being-executed.--This-feature-of-Spark-is-called-%22lazy-evaluation%22.--This-allows-Spark-to-avoid-performing-unnecessary-calculations." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[26]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.5996px; left: 299.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">xrangeRDD = sc.parallelize(data, 8)</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 574.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 51px; width: 294px; height: 17px;" class="CodeMirror-selected"></div></div><div style="visibility: hidden;" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Parallelize data using 8 partitions</span></span></pre><pre class=""><span><span class="cm-comment"># This operation is a transformation of data into an RDD</span></span></pre><pre class=""><span><span class="cm-comment"># Spark uses lazy evaluation, so no Spark jobs are run at this point</span></span></pre><pre class=""><span><span class="cm-variable">xrangeRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>(<span class="cm-variable">data</span>, <span class="cm-number">8</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[27]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 271.8px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's view help on parallelize</span></span></pre><pre class=""><span><span class="cm-builtin">help</span>(<span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Help on method parallelize in module pyspark.context:

parallelize(self, c, numSlices=None) method of pyspark.context.SparkContext instance
    Distribute a local Python collection to form an RDD. Using xrange
    is recommended if the input represents a range for performance.
    
    &gt;&gt;&gt; sc.parallelize([0, 2, 3, 4, 6], 5).glom().collect()
    [[0], [2], [3], [4], [6]]
    &gt;&gt;&gt; sc.parallelize(xrange(0, 6, 2), 5).glom().collect()
    [[], [0], [], [2], [4]]

</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[29]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 107.6px; left: 476px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 473.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 470.4px; top: 102px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's see what type sc.parallelize() returned</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">'type of xrangeRDD: {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-builtin">type</span>(<span class="cm-variable">xrangeRDD</span>))</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># How about if we use a range</span></span></pre><pre class=""><span><span class="cm-variable">dataRange</span> = <span class="cm-builtin">range</span>(<span class="cm-number">1</span>, <span class="cm-number">10001</span>)</span></pre><pre class=""><span><span class="cm-variable">rangeRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>(<span class="cm-variable">dataRange</span>, <span class="cm-number">8</span>)</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-string">'type of dataRangeRDD: {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-builtin">type</span>(<span class="cm-variable">rangeRDD</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 130px;"></div><div style="display: none; height: 160px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>type of xrangeRDD: &lt;class 'pyspark.rdd.PipelinedRDD'&gt;
type of dataRangeRDD: &lt;class 'pyspark.rdd.RDD'&gt;
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[30]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6016px; left: 408.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">print 'xrangeRDD id: {0}'.format(xrangeRDD.id())</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 406.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 17px; width: 403.2px; height: 17px;" class="CodeMirror-selected"></div></div><div style="visibility: hidden;" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Each RDD gets a unique ID</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">'xrangeRDD id: {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">xrangeRDD</span>.<span class="cm-builtin">id</span>())</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">'rangeRDD id: {0}'</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">rangeRDD</span>.<span class="cm-builtin">id</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>xrangeRDD id: 2
rangeRDD id: 1
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[38]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5996px; left: 719.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">print "extra_rdd info: id ({0}), name ({1})".format(extra_rdd.id(), extra_rdd.name())</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 717px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 34px; width: 714px; height: 17px;" class="CodeMirror-selected"></div></div><div style="visibility: hidden;" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-variable">extra_rdd</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>(<span class="cm-builtin">xrange</span>(<span class="cm-number">100</span>), <span class="cm-number">6</span>)</span></pre><pre class=""><span><span class="cm-variable">extra_rdd</span>.<span class="cm-variable">setName</span>(<span class="cm-string">"Extra xrange RDD"</span>)</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">"extra_rdd info: id ({0}), name ({1})"</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">extra_rdd</span>.<span class="cm-builtin">id</span>(), <span class="cm-variable">extra_rdd</span>.<span class="cm-variable">name</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre> extra_rdd info: id (16), name (Extra xrange RDD)
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[40]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5996px; left: 719.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">print "xrangeRDD info: id ({0}), name ({1})".format(xrangeRDD.id(), xrangeRDD.name())</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 717px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 34px; width: 714px; height: 17px;" class="CodeMirror-selected"></div></div><div style="" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># We can name each newly created RDD using the setName() method</span></span></pre><pre class=""><span><span class="cm-variable">xrangeRDD</span>.<span class="cm-variable">setName</span>(<span class="cm-string">'My first RDD'</span>)</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-string">"xrangeRDD info: id ({0}), name ({1})"</span>.<span class="cm-builtin">format</span>(<span class="cm-variable">xrangeRDD</span>.<span class="cm-builtin">id</span>(), <span class="cm-variable">xrangeRDD</span>.<span class="cm-variable">name</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>xrangeRDD info: id (2), name (My first RDD)
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[42]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 240.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 725.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 235.2px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's view the lineage (the set of transformations) of the RDD using toDebugString()</span></span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">xrangeRDD</span>.<span class="cm-variable">toDebugString</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>(8) My first RDD PythonRDD[2] at RDD at PythonRDD.scala:43 []
 |  ParallelCollectionRDD[0] at parallelize at PythonRDD.scala:392 []
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[49]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6016px; left: 22.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"># </textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 507px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 16.8px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's use help to see what methods we can call on this RDD</span></span></pre><pre><span><span class="cm-comment"># help(xrangeRDD)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[50]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5996px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">xrangeRDD.getNumPartitions()</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 759px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 17px; width: 235.2px; height: 17px;" class="CodeMirror-selected"></div></div><div style="" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's see how many partitions the RDD will be split into by using the getNumPartitions()</span></span></pre><pre><span><span class="cm-variable">xrangeRDD</span>.<span class="cm-variable">getNumPartitions</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[50]:</div><div class="output_subarea output_text output_result"><pre>8</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 716px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">**(3c): Subtract one from each value using </span><span class="cm-strong cm-comment cm-header cm-header-4">`map`</span><span class="cm-strong cm-header cm-header-4">**</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### So far, we've created a distributed dataset that is split into many partitions, where each partition is stored on a single machine in our cluster.  Let's look at what happens when we do a basic operation on the dataset.  Many useful data analysis operations can be specified as "do something to each item in the dataset".  These data-parallel operations are convenient because each item in the dataset can be processed individually: the operation on one entry doesn't effect the operations on any of the other entries.  Therefore, Spark can parallelize the operation.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-comment cm-header cm-header-4">`map(f)`</span><span class="cm-header cm-header-4">, the most common Spark transformation, is one such example: it applies a function </span><span class="cm-comment cm-header cm-header-4">`f`</span><span class="cm-header cm-header-4"> to each item in the dataset, and outputs the resulting dataset.  When you run </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> on a dataset, a single </span><span class="cm-em cm-header cm-header-4">*stage*</span><span class="cm-header cm-header-4"> of tasks is launched.  A </span><span class="cm-em cm-header cm-header-4">*stage*</span><span class="cm-header cm-header-4"> is a group of tasks that all perform the same computation, but on different input data.  One task is launched for each partitition, as shown in the example below.  A task is a unit of execution that runs on a single machine. When we run </span><span class="cm-comment cm-header cm-header-4">`map(f)`</span><span class="cm-header cm-header-4"> within a partition, a new </span><span class="cm-em cm-header cm-header-4">*task*</span><span class="cm-header cm-header-4"> applies </span><span class="cm-comment cm-header cm-header-4">`f`</span><span class="cm-header cm-header-4"> to all of the entries in a particular partition, and outputs a new partition. In this example figure, the dataset is broken into four partitions, so four </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> tasks are launched.</span></span></pre><pre class=""><span><span class="cm-tag">![tasks]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/tasks.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The figure below shows how this would work on the smaller data set from the earlier figures.  Note that one task is launched for each partition.</span></span></pre><pre class=""><span><span class="cm-tag">![foo]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/map.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### When applying the </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> transformation, each item in the parent RDD will map to one element in the new RDD. So, if the parent RDD has twenty elements, the new RDD will also have twenty items.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Now we will use </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> to subtract one from each value in the base RDD we just created. First, we define a Python function called </span><span class="cm-comment cm-header cm-header-4">`sub()`</span><span class="cm-header cm-header-4"> that will subtract one from the input integer. Second, we will pass each item in the base RDD into a </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> transformation that applies the </span><span class="cm-comment cm-header cm-header-4">`sub()`</span><span class="cm-header cm-header-4"> function to each element. And finally, we print out the RDD transformation hierarchy using </span><span class="cm-comment cm-header cm-header-4">`toDebugString()`</span><span class="cm-header cm-header-4">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 716px;"></div><div style="display: none; height: 746px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="(3c):-Subtract-one-from-each-value-using-map"><strong>(3c): Subtract one from each value using <code>map</code></strong><a href="#%283c%29:-Subtract-one-from-each-value-using-map" class="anchor-link">¶</a></h4>
<h4 id="So-far,-we've-created-a-distributed-dataset-that-is-split-into-many-partitions,-where-each-partition-is-stored-on-a-single-machine-in-our-cluster.--Let's-look-at-what-happens-when-we-do-a-basic-operation-on-the-dataset.--Many-useful-data-analysis-operations-can-be-specified-as-&quot;do-something-to-each-item-in-the-dataset&quot;.--These-data-parallel-operations-are-convenient-because-each-item-in-the-dataset-can-be-processed-individually:-the-operation-on-one-entry-doesn't-effect-the-operations-on-any-of-the-other-entries.--Therefore,-Spark-can-parallelize-the-operation.">So
 far, we've created a distributed dataset that is split into many 
partitions, where each partition is stored on a single machine in our 
cluster.  Let's look at what happens when we do a basic operation on the
 dataset.  Many useful data analysis operations can be specified as "do 
something to each item in the dataset".  These data-parallel operations 
are convenient because each item in the dataset can be processed 
individually: the operation on one entry doesn't effect the operations 
on any of the other entries.  Therefore, Spark can parallelize the 
operation.<a href="#So-far,-we%27ve-created-a-distributed-dataset-that-is-split-into-many-partitions,-where-each-partition-is-stored-on-a-single-machine-in-our-cluster.--Let%27s-look-at-what-happens-when-we-do-a-basic-operation-on-the-dataset.--Many-useful-data-analysis-operations-can-be-specified-as-%22do-something-to-each-item-in-the-dataset%22.--These-data-parallel-operations-are-convenient-because-each-item-in-the-dataset-can-be-processed-individually:-the-operation-on-one-entry-doesn%27t-effect-the-operations-on-any-of-the-other-entries.--Therefore,-Spark-can-parallelize-the-operation." class="anchor-link">¶</a></h4>
<h4 id="map(f),-the-most-common-Spark-transformation,-is-one-such-example:-it-applies-a-function-f-to-each-item-in-the-dataset,-and-outputs-the-resulting-dataset.--When-you-run-map()-on-a-dataset,-a-single-stage-of-tasks-is-launched.--A-stage-is-a-group-of-tasks-that-all-perform-the-same-computation,-but-on-different-input-data.--One-task-is-launched-for-each-partitition,-as-shown-in-the-example-below.--A-task-is-a-unit-of-execution-that-runs-on-a-single-machine.-When-we-run-map(f)-within-a-partition,-a-new-task-applies-f-to-all-of-the-entries-in-a-particular-partition,-and-outputs-a-new-partition.-In-this-example-figure,-the-dataset-is-broken-into-four-partitions,-so-four-map()-tasks-are-launched."><code>map(f)</code>, the most common Spark transformation, is one such example: it applies a function <code>f</code> to each item in the dataset, and outputs the resulting dataset.  When you run <code>map()</code> on a dataset, a single <em>stage</em> of tasks is launched.  A <em>stage</em>
 is a group of tasks that all perform the same computation, but on 
different input data.  One task is launched for each partitition, as 
shown in the example below.  A task is a unit of execution that runs on a
 single machine. When we run <code>map(f)</code> within a partition, a new <em>task</em> applies <code>f</code>
 to all of the entries in a particular partition, and outputs a new 
partition. In this example figure, the dataset is broken into four 
partitions, so four <code>map()</code> tasks are launched.<a href="#map%28f%29,-the-most-common-Spark-transformation,-is-one-such-example:-it-applies-a-function-f-to-each-item-in-the-dataset,-and-outputs-the-resulting-dataset.--When-you-run-map%28%29-on-a-dataset,-a-single-stage-of-tasks-is-launched.--A-stage-is-a-group-of-tasks-that-all-perform-the-same-computation,-but-on-different-input-data.--One-task-is-launched-for-each-partitition,-as-shown-in-the-example-below.--A-task-is-a-unit-of-execution-that-runs-on-a-single-machine.-When-we-run-map%28f%29-within-a-partition,-a-new-task-applies-f-to-all-of-the-entries-in-a-particular-partition,-and-outputs-a-new-partition.-In-this-example-figure,-the-dataset-is-broken-into-four-partitions,-so-four-map%28%29-tasks-are-launched." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/tasks.png" alt="tasks"></p>
<h4 id="The-figure-below-shows-how-this-would-work-on-the-smaller-data-set-from-the-earlier-figures.--Note-that-one-task-is-launched-for-each-partition.">The
 figure below shows how this would work on the smaller data set from the
 earlier figures.  Note that one task is launched for each partition.<a href="#The-figure-below-shows-how-this-would-work-on-the-smaller-data-set-from-the-earlier-figures.--Note-that-one-task-is-launched-for-each-partition." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/map.png" alt="foo"></p>
<h4 id="When-applying-the-map()-transformation,-each-item-in-the-parent-RDD-will-map-to-one-element-in-the-new-RDD.-So,-if-the-parent-RDD-has-twenty-elements,-the-new-RDD-will-also-have-twenty-items.">When applying the <code>map()</code>
 transformation, each item in the parent RDD will map to one element in 
the new RDD. So, if the parent RDD has twenty elements, the new RDD will
 also have twenty items.<a href="#When-applying-the-map%28%29-transformation,-each-item-in-the-parent-RDD-will-map-to-one-element-in-the-new-RDD.-So,-if-the-parent-RDD-has-twenty-elements,-the-new-RDD-will-also-have-twenty-items." class="anchor-link">¶</a></h4>
<h4 id="Now-we-will-use-map()-to-subtract-one-from-each-value-in-the-base-RDD-we-just-created.-First,-we-define-a-Python-function-called-sub()-that-will-subtract-one-from-the-input-integer.-Second,-we-will-pass-each-item-in-the-base-RDD-into-a-map()-transformation-that-applies-the-sub()-function-to-each-element.-And-finally,-we-print-out-the-RDD-transformation-hierarchy-using-toDebugString().">Now we will use <code>map()</code> to subtract one from each value in the base RDD we just created. First, we define a Python function called <code>sub()</code> that will subtract one from the input integer. Second, we will pass each item in the base RDD into a <code>map()</code> transformation that applies the <code>sub()</code> function to each element. And finally, we print out the RDD transformation hierarchy using <code>toDebugString()</code>.<a href="#Now-we-will-use-map%28%29-to-subtract-one-from-each-value-in-the-base-RDD-we-just-created.-First,-we-define-a-Python-function-called-sub%28%29-that-will-subtract-one-from-the-input-integer.-Second,-we-will-pass-each-item-in-the-base-RDD-into-a-map%28%29-transformation-that-applies-the-sub%28%29-function-to-each-element.-And-finally,-we-print-out-the-RDD-transformation-hierarchy-using-toDebugString%28%29." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[57]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 311.6px; left: 240.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px; bottom: 0px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 691.8px; margin-bottom: 0px; border-right-width: 30px; min-height: 334px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 235.2px; top: 306px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Create sub function to subtract 1</span></span></pre><pre class=""><span><span class="cm-keyword">def</span> <span class="cm-def">sub</span>(<span class="cm-variable">value</span>):</span></pre><pre class=""><span>    <span class="cm-string">""""Subtracts one from `value`.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Args:</span></span></pre><pre class=""><span><span class="cm-string">       value (int): A number.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Returns:</span></span></pre><pre class=""><span><span class="cm-string">        int: `value` minus one.</span></span></pre><pre class=""><span><span class="cm-string">    """</span></span></pre><pre class=""><span>    <span class="cm-keyword">return</span> (<span class="cm-variable">value</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>)</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># Transform xrangeRDD through map transformation using sub function</span></span></pre><pre class=""><span><span class="cm-comment"># Because map is a transformation and Spark uses lazy evaluation, no jobs, stages,</span></span></pre><pre class=""><span><span class="cm-comment"># or tasks will be launched when we run this code.</span></span></pre><pre><span><span class="cm-variable">subRDD</span> = <span class="cm-variable">xrangeRDD</span>.<span class="cm-builtin">map</span>(<span class="cm-variable">sub</span>)</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># Let's see the RDD transformation hierarchy</span></span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">subRDD</span>.<span class="cm-variable">toDebugString</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 334px;"></div><div style="display: none; height: 364px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>(8) PythonRDD[20] at RDD at PythonRDD.scala:43 []
 |  ParallelCollectionRDD[0] at parallelize at PythonRDD.scala:392 []
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 441px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (3d) Perform action </span><span class="cm-strong cm-comment cm-header cm-header-4">`collect`</span><span class="cm-strong cm-header cm-header-4"> to view results **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To see a list of elements decremented by one, we need to create a new list on the driver from the the data distributed in the executor nodes.  To do this we call the </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> method on our RDD.  </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> is often used after a filter or other operation to ensure that we are only returning a </span><span class="cm-em cm-header cm-header-4">*small*</span><span class="cm-header cm-header-4"> amount of data to the driver.  This is done because the data returned to the driver must fit into the driver's available memory.  If not, the driver will crash.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> method is the first action operation that we have encountered.  Action operations cause Spark to perform the (lazy) transformation operations that are required to compute the RDD returned by the action.  In our example, this means that tasks will now be launched to perform the </span><span class="cm-comment cm-header cm-header-4">`parallelize`</span><span class="cm-header cm-header-4">, </span><span class="cm-comment cm-header cm-header-4">`map`</span><span class="cm-header cm-header-4">, and </span><span class="cm-comment cm-header cm-header-4">`collect`</span><span class="cm-header cm-header-4"> operations.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### In this example, the dataset is broken into four partitions, so four </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> tasks are launched. Each task collects the entries in its partition and sends the result to the SparkContext, which creates a list of the values, as shown in the figure below.</span></span></pre><pre class=""><span><span class="cm-tag">![collect]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/collect.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The above figures showed what would happen if we ran </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> on a small example dataset with just four partitions.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Now let's run </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> on </span><span class="cm-comment cm-header cm-header-4">`subRDD`</span><span class="cm-header cm-header-4">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 441px;"></div><div style="display: none; height: 471px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(3d)-Perform-action-collect-to-view-results-"><strong> (3d) Perform action <code>collect</code> to view results </strong><a href="#-%283d%29-Perform-action-collect-to-view-results-" class="anchor-link">¶</a></h4>
<h4 id="To-see-a-list-of-elements-decremented-by-one,-we-need-to-create-a-new-list-on-the-driver-from-the-the-data-distributed-in-the-executor-nodes.--To-do-this-we-call-the-collect()-method-on-our-RDD.--collect()-is-often-used-after-a-filter-or-other-operation-to-ensure-that-we-are-only-returning-a-small-amount-of-data-to-the-driver.--This-is-done-because-the-data-returned-to-the-driver-must-fit-into-the-driver's-available-memory.--If-not,-the-driver-will-crash.">To
 see a list of elements decremented by one, we need to create a new list
 on the driver from the the data distributed in the executor nodes.  To 
do this we call the <code>collect()</code> method on our RDD.  <code>collect()</code> is often used after a filter or other operation to ensure that we are only returning a <em>small</em>
 amount of data to the driver.  This is done because the data returned 
to the driver must fit into the driver's available memory.  If not, the 
driver will crash.<a href="#To-see-a-list-of-elements-decremented-by-one,-we-need-to-create-a-new-list-on-the-driver-from-the-the-data-distributed-in-the-executor-nodes.--To-do-this-we-call-the-collect%28%29-method-on-our-RDD.--collect%28%29-is-often-used-after-a-filter-or-other-operation-to-ensure-that-we-are-only-returning-a-small-amount-of-data-to-the-driver.--This-is-done-because-the-data-returned-to-the-driver-must-fit-into-the-driver%27s-available-memory.--If-not,-the-driver-will-crash." class="anchor-link">¶</a></h4>
<h4 id="The-collect()-method-is-the-first-action-operation-that-we-have-encountered.--Action-operations-cause-Spark-to-perform-the-(lazy)-transformation-operations-that-are-required-to-compute-the-RDD-returned-by-the-action.--In-our-example,-this-means-that-tasks-will-now-be-launched-to-perform-the-parallelize,-map,-and-collect-operations.">The <code>collect()</code>
 method is the first action operation that we have encountered.  Action 
operations cause Spark to perform the (lazy) transformation operations 
that are required to compute the RDD returned by the action.  In our 
example, this means that tasks will now be launched to perform the <code>parallelize</code>, <code>map</code>, and <code>collect</code> operations.<a href="#The-collect%28%29-method-is-the-first-action-operation-that-we-have-encountered.--Action-operations-cause-Spark-to-perform-the-%28lazy%29-transformation-operations-that-are-required-to-compute-the-RDD-returned-by-the-action.--In-our-example,-this-means-that-tasks-will-now-be-launched-to-perform-the-parallelize,-map,-and-collect-operations." class="anchor-link">¶</a></h4>
<h4 id="In-this-example,-the-dataset-is-broken-into-four-partitions,-so-four-collect()-tasks-are-launched.-Each-task-collects-the-entries-in-its-partition-and-sends-the-result-to-the-SparkContext,-which-creates-a-list-of-the-values,-as-shown-in-the-figure-below.">In this example, the dataset is broken into four partitions, so four <code>collect()</code>
 tasks are launched. Each task collects the entries in its partition and
 sends the result to the SparkContext, which creates a list of the 
values, as shown in the figure below.<a href="#In-this-example,-the-dataset-is-broken-into-four-partitions,-so-four-collect%28%29-tasks-are-launched.-Each-task-collects-the-entries-in-its-partition-and-sends-the-result-to-the-SparkContext,-which-creates-a-list-of-the-values,-as-shown-in-the-figure-below." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/collect.png" alt="collect"></p>
<h4 id="The-above-figures-showed-what-would-happen-if-we-ran-collect()-on-a-small-example-dataset-with-just-four-partitions.">The above figures showed what would happen if we ran <code>collect()</code> on a small example dataset with just four partitions.<a href="#The-above-figures-showed-what-would-happen-if-we-ran-collect%28%29-on-a-small-example-dataset-with-just-four-partitions." class="anchor-link">¶</a></h4>
<h4 id="Now-let's-run-collect()-on-subRDD.">Now let's run <code>collect()</code> on <code>subRDD</code>.<a href="#Now-let%27s-run-collect%28%29-on-subRDD." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[54]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6006px; left: 89.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">DD</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 246.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 84px; top: 34px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's collect the data</span></span></pre><pre class=""><span><span class="cm-comment"># print subRDD.collect()</span></span></pre><pre class=""><span><span class="cm-variable">collectRDD</span> = <span class="cm-variable">subRDD</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-builtin">type</span>(<span class="cm-variable">collectRDD</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[54]:</div><div class="output_subarea output_text output_result"><pre>list</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[62]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5996px; left: 324.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">collect_rdd2_list = sub_rdd2.collect()</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 414.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 34px; width: 319.2px; height: 17px;" class="CodeMirror-selected"></div></div><div style="visibility: hidden;" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># using a lambda function instead of create sub()</span></span></pre><pre class=""><span><span class="cm-variable">sub_rdd2</span> = <span class="cm-variable">xrangeRDD</span>.<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span><span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=""><span><span class="cm-variable">collect_rdd2_list</span> = <span class="cm-variable">sub_rdd2</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-builtin">type</span>(<span class="cm-variable">collect_rdd2_list</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[62]:</div><div class="output_subarea output_text output_result"><pre>list</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 303px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (3d) Perform action </span><span class="cm-strong cm-comment cm-header cm-header-4">`count`</span><span class="cm-strong cm-header cm-header-4"> to view counts **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### One of the most basic jobs that we can run is the </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4"> job which will count the number of elements in an RDD using the </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4"> action. Since </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> creates a new RDD with the same number of elements as the starting RDD, we expect that applying </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4"> to each RDD will return the same result.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Note that because </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4"> is an action operation, if we had not already performed an action with </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4">, then Spark would now perform the transformation operations when we executed </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Each task counts the entries in its partition and sends the result to your SparkContext, which adds up all of the counts. The figure below shows what would happen if we ran </span><span class="cm-comment cm-header cm-header-4">`count()`</span><span class="cm-header cm-header-4"> on a small example dataset with just four partitions.</span></span></pre><pre class=""><span><span class="cm-tag">![count]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/count.png)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 303px;"></div><div style="display: none; height: 333px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(3d)-Perform-action-count-to-view-counts-"><strong> (3d) Perform action <code>count</code> to view counts </strong><a href="#-%283d%29-Perform-action-count-to-view-counts-" class="anchor-link">¶</a></h4>
<h4 id="One-of-the-most-basic-jobs-that-we-can-run-is-the-count()-job-which-will-count-the-number-of-elements-in-an-RDD-using-the-count()-action.-Since-map()-creates-a-new-RDD-with-the-same-number-of-elements-as-the-starting-RDD,-we-expect-that-applying-count()-to-each-RDD-will-return-the-same-result.">One of the most basic jobs that we can run is the <code>count()</code> job which will count the number of elements in an RDD using the <code>count()</code> action. Since <code>map()</code> creates a new RDD with the same number of elements as the starting RDD, we expect that applying <code>count()</code> to each RDD will return the same result.<a href="#One-of-the-most-basic-jobs-that-we-can-run-is-the-count%28%29-job-which-will-count-the-number-of-elements-in-an-RDD-using-the-count%28%29-action.-Since-map%28%29-creates-a-new-RDD-with-the-same-number-of-elements-as-the-starting-RDD,-we-expect-that-applying-count%28%29-to-each-RDD-will-return-the-same-result." class="anchor-link">¶</a></h4>
<h4 id="Note-that-because-count()-is-an-action-operation,-if-we-had-not-already-performed-an-action-with-collect(),-then-Spark-would-now-perform-the-transformation-operations-when-we-executed-count().">Note that because <code>count()</code> is an action operation, if we had not already performed an action with <code>collect()</code>, then Spark would now perform the transformation operations when we executed <code>count()</code>.<a href="#Note-that-because-count%28%29-is-an-action-operation,-if-we-had-not-already-performed-an-action-with-collect%28%29,-then-Spark-would-now-perform-the-transformation-operations-when-we-executed-count%28%29." class="anchor-link">¶</a></h4>
<h4 id="Each-task-counts-the-entries-in-its-partition-and-sends-the-result-to-your-SparkContext,-which-adds-up-all-of-the-counts.-The-figure-below-shows-what-would-happen-if-we-ran-count()-on-a-small-example-dataset-with-just-four-partitions.">Each
 task counts the entries in its partition and sends the result to your 
SparkContext, which adds up all of the counts. The figure below shows 
what would happen if we ran <code>count()</code> on a small example dataset with just four partitions.<a href="#Each-task-counts-the-entries-in-its-partition-and-sends-the-result-to-your-SparkContext,-which-adds-up-all-of-the-counts.-The-figure-below-shows-what-would-happen-if-we-ran-count%28%29-on-a-small-example-dataset-with-just-four-partitions." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/count.png" alt="count"></p>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[63]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6006px; left: 123.2px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">sub_rdd2</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 196.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 50.4px; top: 34px; width: 67.2px; height: 17px;" class="CodeMirror-selected"></div></div><div style="visibility: hidden;" class="CodeMirror-cursors"></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">xrangeRDD</span>.<span class="cm-variable">count</span>()</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">subRDD</span>.<span class="cm-variable">count</span>()</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">sub_rdd2</span>.<span class="cm-variable">count</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>10000
10000
10000
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 421px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (3e) Apply transformation </span><span class="cm-strong cm-comment cm-header cm-header-4">`filter`</span><span class="cm-strong cm-header cm-header-4"> and view results with </span><span class="cm-strong cm-comment cm-header cm-header-4">`collect`</span><span class="cm-strong cm-header cm-header-4"> **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Next, we'll create a new RDD that only contains the values less than ten by using the </span><span class="cm-comment cm-header cm-header-4">`filter(f)`</span><span class="cm-header cm-header-4"> data-parallel operation. The </span><span class="cm-comment cm-header cm-header-4">`filter(f)`</span><span class="cm-header cm-header-4"> method is a transformation operation that creates a new RDD from the input RDD by applying filter function </span><span class="cm-comment cm-header cm-header-4">`f`</span><span class="cm-header cm-header-4"> to each item in the parent RDD and only passing those elements where the filter function returns </span><span class="cm-comment cm-header cm-header-4">`True`</span><span class="cm-header cm-header-4">. Elements that do not return </span><span class="cm-comment cm-header cm-header-4">`True`</span><span class="cm-header cm-header-4"> will be dropped. Like </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4">, filter can be applied individually to each entry in the dataset, so is easily parallelized using Spark.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The figure below shows how this would work on the small four-partition dataset.</span></span></pre><pre class=""><span><span class="cm-tag">![filter]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/filter.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To filter this dataset, we'll define a function called </span><span class="cm-comment cm-header cm-header-4">`ten()`</span><span class="cm-header cm-header-4">, which returns </span><span class="cm-comment cm-header cm-header-4">`True`</span><span class="cm-header cm-header-4"> if the input is less than 10 and </span><span class="cm-comment cm-header cm-header-4">`False`</span><span class="cm-header cm-header-4"> otherwise.  This function will be passed to the </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> transformation as the filter function </span><span class="cm-comment cm-header cm-header-4">`f`</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To view the filtered list of elements less than ten, we need to create a new list on the driver from the distributed data on the executor nodes.  We use the </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> method to return a list that contains all of the elements in this filtered RDD to the driver program.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 421px;"></div><div style="display: none; height: 451px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(3e)-Apply-transformation-filter-and-view-results-with-collect-"><strong> (3e) Apply transformation <code>filter</code> and view results with <code>collect</code> </strong><a href="#-%283e%29-Apply-transformation-filter-and-view-results-with-collect-" class="anchor-link">¶</a></h4>
<h4 id="Next,-we'll-create-a-new-RDD-that-only-contains-the-values-less-than-ten-by-using-the-filter(f)-data-parallel-operation.-The-filter(f)-method-is-a-transformation-operation-that-creates-a-new-RDD-from-the-input-RDD-by-applying-filter-function-f-to-each-item-in-the-parent-RDD-and-only-passing-those-elements-where-the-filter-function-returns-True.-Elements-that-do-not-return-True-will-be-dropped.-Like-map(),-filter-can-be-applied-individually-to-each-entry-in-the-dataset,-so-is-easily-parallelized-using-Spark.">Next, we'll create a new RDD that only contains the values less than ten by using the <code>filter(f)</code> data-parallel operation. The <code>filter(f)</code> method is a transformation operation that creates a new RDD from the input RDD by applying filter function <code>f</code> to each item in the parent RDD and only passing those elements where the filter function returns <code>True</code>. Elements that do not return <code>True</code> will be dropped. Like <code>map()</code>, filter can be applied individually to each entry in the dataset, so is easily parallelized using Spark.<a href="#Next,-we%27ll-create-a-new-RDD-that-only-contains-the-values-less-than-ten-by-using-the-filter%28f%29-data-parallel-operation.-The-filter%28f%29-method-is-a-transformation-operation-that-creates-a-new-RDD-from-the-input-RDD-by-applying-filter-function-f-to-each-item-in-the-parent-RDD-and-only-passing-those-elements-where-the-filter-function-returns-True.-Elements-that-do-not-return-True-will-be-dropped.-Like-map%28%29,-filter-can-be-applied-individually-to-each-entry-in-the-dataset,-so-is-easily-parallelized-using-Spark." class="anchor-link">¶</a></h4>
<h4 id="The-figure-below-shows-how-this-would-work-on-the-small-four-partition-dataset.">The figure below shows how this would work on the small four-partition dataset.<a href="#The-figure-below-shows-how-this-would-work-on-the-small-four-partition-dataset." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/filter.png" alt="filter"></p>
<h4 id="To-filter-this-dataset,-we'll-define-a-function-called-ten(),-which-returns-True-if-the-input-is-less-than-10-and-False-otherwise.--This-function-will-be-passed-to-the-filter()-transformation-as-the-filter-function-f.">To filter this dataset, we'll define a function called <code>ten()</code>, which returns <code>True</code> if the input is less than 10 and <code>False</code> otherwise.  This function will be passed to the <code>filter()</code> transformation as the filter function <code>f</code>.<a href="#To-filter-this-dataset,-we%27ll-define-a-function-called-ten%28%29,-which-returns-True-if-the-input-is-less-than-10-and-False-otherwise.--This-function-will-be-passed-to-the-filter%28%29-transformation-as-the-filter-function-f." class="anchor-link">¶</a></h4>
<h4 id="To-view-the-filtered-list-of-elements-less-than-ten,-we-need-to-create-a-new-list-on-the-driver-from-the-distributed-data-on-the-executor-nodes.--We-use-the-collect()-method-to-return-a-list-that-contains-all-of-the-elements-in-this-filtered-RDD-to-the-driver-program.">To
 view the filtered list of elements less than ten, we need to create a 
new list on the driver from the distributed data on the executor nodes. 
 We use the <code>collect()</code> method to return a list that contains all of the elements in this filtered RDD to the driver program.<a href="#To-view-the-filtered-list-of-elements-less-than-ten,-we-need-to-create-a-new-list-on-the-driver-from-the-distributed-data-on-the-executor-nodes.--We-use-the-collect%28%29-method-to-return-a-list-that-contains-all-of-the-elements-in-this-filtered-RDD-to-the-driver-program." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[64]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 311.6px; left: 274.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px; bottom: 0px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 742.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 402px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 268.8px; top: 306px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Define a function to filter a single value</span></span></pre><pre class=""><span><span class="cm-keyword">def</span> <span class="cm-def">ten</span>(<span class="cm-variable">value</span>):</span></pre><pre class=""><span>    <span class="cm-string">"""Return whether value is below ten.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Args:</span></span></pre><pre class=""><span><span class="cm-string">        value (int): A number.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Returns:</span></span></pre><pre class=""><span><span class="cm-string">        bool: Whether `value` is less than ten.</span></span></pre><pre class=""><span><span class="cm-string">    """</span></span></pre><pre class=""><span>    <span class="cm-keyword">if</span> (<span class="cm-variable">value</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>):</span></pre><pre class=""><span>        <span class="cm-keyword">return</span> <span class="cm-builtin">True</span></span></pre><pre class=""><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=""><span>        <span class="cm-keyword">return</span> <span class="cm-builtin">False</span></span></pre><pre class=""><span><span class="cm-comment"># The ten function could also be written concisely as: def ten(value): return value &lt; 10</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># Pass the function ten to the filter transformation</span></span></pre><pre class=""><span><span class="cm-comment"># Filter is a transformation so no tasks are run</span></span></pre><pre><span><span class="cm-variable">filteredRDD</span> = <span class="cm-variable">subRDD</span>.<span class="cm-builtin">filter</span>(<span class="cm-variable">ten</span>)</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># View the results using collect()</span></span></pre><pre class=""><span><span class="cm-comment"># Collect is an action and triggers the filter transformation to run</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 402px;"></div><div style="display: none; height: 432px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell unselected rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 32px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 20.35px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">** Part 4: Lambda Functions **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 32px;"></div><div style="display: none; height: 62px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="-Part-4:-Lambda-Functions-"><strong> Part 4: Lambda Functions </strong><a href="#-Part-4:-Lambda-Functions-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 288px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (4a) Using Python </span><span class="cm-strong cm-comment cm-header cm-header-4">`lambda()`</span><span class="cm-strong cm-header cm-header-4"> functions **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Python supports the use of small one-line anonymous functions that are not bound to a name at runtime. Borrowed from LISP, these </span><span class="cm-comment cm-header cm-header-4">`lambda`</span><span class="cm-header cm-header-4"> functions can be used wherever function objects are required. They are syntactically restricted to a single expression. Remember that </span><span class="cm-comment cm-header cm-header-4">`lambda`</span><span class="cm-header cm-header-4"> functions are a matter of style and using them is never required - semantically, they are just syntactic sugar for a normal function definition. You can always define a separate normal function instead, but using a </span><span class="cm-comment cm-header cm-header-4">`lambda()`</span><span class="cm-header cm-header-4"> function is an equivalent and more compact form of coding. Ideally you should consider using </span><span class="cm-comment cm-header cm-header-4">`lambda`</span><span class="cm-header cm-header-4"> functions where you want to encapsulate non-reusable code without littering your code with one-line functions.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Here, instead of defining a separate function for the </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> transformation, we will use an inline </span><span class="cm-comment cm-header cm-header-4">`lambda()`</span><span class="cm-header cm-header-4"> function.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 288px;"></div><div style="display: none; height: 318px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(4a)-Using-Python-lambda()-functions-"><strong> (4a) Using Python <code>lambda()</code> functions </strong><a href="#-%284a%29-Using-Python-lambda%28%29-functions-" class="anchor-link">¶</a></h4>
<h4 id="Python-supports-the-use-of-small-one-line-anonymous-functions-that-are-not-bound-to-a-name-at-runtime.-Borrowed-from-LISP,-these-lambda-functions-can-be-used-wherever-function-objects-are-required.-They-are-syntactically-restricted-to-a-single-expression.-Remember-that-lambda-functions-are-a-matter-of-style-and-using-them-is-never-required---semantically,-they-are-just-syntactic-sugar-for-a-normal-function-definition.-You-can-always-define-a-separate-normal-function-instead,-but-using-a-lambda()-function-is-an-equivalent-and-more-compact-form-of-coding.-Ideally-you-should-consider-using-lambda-functions-where-you-want-to-encapsulate-non-reusable-code-without-littering-your-code-with-one-line-functions.">Python
 supports the use of small one-line anonymous functions that are not 
bound to a name at runtime. Borrowed from LISP, these <code>lambda</code>
 functions can be used wherever function objects are required. They are 
syntactically restricted to a single expression. Remember that <code>lambda</code>
 functions are a matter of style and using them is never required - 
semantically, they are just syntactic sugar for a normal function 
definition. You can always define a separate normal function instead, 
but using a <code>lambda()</code> function is an equivalent and more compact form of coding. Ideally you should consider using <code>lambda</code> functions where you want to encapsulate non-reusable code without littering your code with one-line functions.<a href="#Python-supports-the-use-of-small-one-line-anonymous-functions-that-are-not-bound-to-a-name-at-runtime.-Borrowed-from-LISP,-these-lambda-functions-can-be-used-wherever-function-objects-are-required.-They-are-syntactically-restricted-to-a-single-expression.-Remember-that-lambda-functions-are-a-matter-of-style-and-using-them-is-never-required---semantically,-they-are-just-syntactic-sugar-for-a-normal-function-definition.-You-can-always-define-a-separate-normal-function-instead,-but-using-a-lambda%28%29-function-is-an-equivalent-and-more-compact-form-of-coding.-Ideally-you-should-consider-using-lambda-functions-where-you-want-to-encapsulate-non-reusable-code-without-littering-your-code-with-one-line-functions." class="anchor-link">¶</a></h4>
<h4 id="Here,-instead-of-defining-a-separate-function-for-the-filter()-transformation,-we-will-use-an-inline-lambda()-function.">Here, instead of defining a separate function for the <code>filter()</code> transformation, we will use an inline <code>lambda()</code> function.<a href="#Here,-instead-of-defining-a-separate-function-for-the-filter%28%29-transformation,-we-will-use-an-inline-lambda%28%29-function." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[65]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 257.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 364.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 252px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-variable">lambdaRDD</span> = <span class="cm-variable">subRDD</span>.<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>)</span></pre><pre class=""><span><span class="cm-variable">lambdaRDD</span>.<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[65]:</div><div class="output_subarea output_text output_result"><pre>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[68]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.5996px; left: 450.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 448.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 445.2px; top: 51px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's collect the even values less than 10</span></span></pre><pre class=""><span><span class="cm-variable">evenRDD</span> = <span class="cm-variable">lambdaRDD</span>.<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span> <span class="cm-operator">%</span> <span class="cm-number">2</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>)</span></pre><pre class=""><span><span class="cm-variable">evenRDD</span>.<span class="cm-variable">collect</span>()</span></pre><pre><span><span class="cm-variable">sub_rdd2</span>.<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span><span class="cm-operator">&lt;</span><span class="cm-number">100</span> <span class="cm-operator">and</span> <span class="cm-variable">x</span> <span class="cm-operator">&gt;</span> <span class="cm-number">80</span>).<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span>​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 96px;"></div><div style="display: none; height: 126px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[68]:</div><div class="output_subarea output_text output_result"><pre>[81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell unselected rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 32px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 20.35px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">** Part 5: Additional RDD actions **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 32px;"></div><div style="display: none; height: 62px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="-Part-5:-Additional-RDD-actions-"><strong> Part 5: Additional RDD actions </strong><a href="#-Part-5:-Additional-RDD-actions-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 693px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (5a) Other common actions **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Let's investigate the additional actions: </span><span class="cm-link cm-header cm-header-4">[first()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.first)</span><span class="cm-header cm-header-4">, </span><span class="cm-link cm-header cm-header-4">[take()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.take)</span><span class="cm-header cm-header-4">, </span><span class="cm-link cm-header cm-header-4">[top()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.top)</span><span class="cm-header cm-header-4">, </span><span class="cm-link cm-header cm-header-4">[takeOrdered()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.takeOrdered)</span><span class="cm-header cm-header-4">, and </span><span class="cm-link cm-header cm-header-4">[reduce()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.reduce)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### One useful thing to do when we have a new dataset is to look at the first few entries to obtain a rough idea of what information is available.  In Spark, we can do that using the </span><span class="cm-comment cm-header cm-header-4">`first()`</span><span class="cm-header cm-header-4">, </span><span class="cm-comment cm-header cm-header-4">`take()`</span><span class="cm-header cm-header-4">, </span><span class="cm-comment cm-header cm-header-4">`top()`</span><span class="cm-header cm-header-4">, and </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> actions. Note that for the </span><span class="cm-comment cm-header cm-header-4">`first()`</span><span class="cm-header cm-header-4"> and </span><span class="cm-comment cm-header cm-header-4">`take()`</span><span class="cm-header cm-header-4"> actions, the elements that are returned depend on how the RDD is </span><span class="cm-em cm-header cm-header-4">*partitioned*</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">####  Instead of using the </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> action, we can use the </span><span class="cm-comment cm-header cm-header-4">`take(n)`</span><span class="cm-header cm-header-4"> action to return the first n elements of the RDD. The </span><span class="cm-comment cm-header cm-header-4">`first()`</span><span class="cm-header cm-header-4"> action returns the first element of an RDD, and is equivalent to </span><span class="cm-comment cm-header cm-header-4">`take(1)`</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> action returns the first n elements of the RDD, using either their natural order or a custom comparator. The key advantage of using </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> instead of </span><span class="cm-comment cm-header cm-header-4">`first()`</span><span class="cm-header cm-header-4"> or </span><span class="cm-comment cm-header cm-header-4">`take()`</span><span class="cm-header cm-header-4"> is that </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> returns a deterministic result, while the other two actions may return differing results, depending on the number of partions or execution environment. </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> returns the list sorted in </span><span class="cm-em cm-header cm-header-4">*ascending order*</span><span class="cm-header cm-header-4">.  The </span><span class="cm-comment cm-header cm-header-4">`top()`</span><span class="cm-header cm-header-4"> action is similar to </span><span class="cm-comment cm-header cm-header-4">`takeOrdered()`</span><span class="cm-header cm-header-4"> except that it returns the list in </span><span class="cm-em cm-header cm-header-4">*descending order.*</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`reduce()`</span><span class="cm-header cm-header-4"> action reduces the elements of a RDD to a single value by applying a function that takes two parameters and returns a single value.  The function should be commutative and associative, as </span><span class="cm-comment cm-header cm-header-4">`reduce()`</span><span class="cm-header cm-header-4"> is applied at the partition level and then again to aggregate results from partitions.  If these rules don't hold, the results from </span><span class="cm-comment cm-header cm-header-4">`reduce()`</span><span class="cm-header cm-header-4"> will be inconsistent.  Reducing locally at partitions makes </span><span class="cm-comment cm-header cm-header-4">`reduce()`</span><span class="cm-header cm-header-4"> very efficient.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 693px;"></div><div style="display: none; height: 723px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(5a)-Other-common-actions-"><strong> (5a) Other common actions </strong><a href="#-%285a%29-Other-common-actions-" class="anchor-link">¶</a></h4>
<h4 id="Let's-investigate-the-additional-actions:-first(),-take(),-top(),-takeOrdered(),-and-reduce()">Let's investigate the additional actions: <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.first">first()</a>, <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.take">take()</a>, <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.top">top()</a>, <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.takeOrdered">takeOrdered()</a>, and <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.reduce">reduce()</a><a href="#Let%27s-investigate-the-additional-actions:-first%28%29,-take%28%29,-top%28%29,-takeOrdered%28%29,-and-reduce%28%29" class="anchor-link">¶</a></h4>
<h4 id="One-useful-thing-to-do-when-we-have-a-new-dataset-is-to-look-at-the-first-few-entries-to-obtain-a-rough-idea-of-what-information-is-available.--In-Spark,-we-can-do-that-using-the-first(),-take(),-top(),-and-takeOrdered()-actions.-Note-that-for-the-first()-and-take()-actions,-the-elements-that-are-returned-depend-on-how-the-RDD-is-partitioned.">One
 useful thing to do when we have a new dataset is to look at the first 
few entries to obtain a rough idea of what information is available.  In
 Spark, we can do that using the <code>first()</code>, <code>take()</code>, <code>top()</code>, and <code>takeOrdered()</code> actions. Note that for the <code>first()</code> and <code>take()</code> actions, the elements that are returned depend on how the RDD is <em>partitioned</em>.<a href="#One-useful-thing-to-do-when-we-have-a-new-dataset-is-to-look-at-the-first-few-entries-to-obtain-a-rough-idea-of-what-information-is-available.--In-Spark,-we-can-do-that-using-the-first%28%29,-take%28%29,-top%28%29,-and-takeOrdered%28%29-actions.-Note-that-for-the-first%28%29-and-take%28%29-actions,-the-elements-that-are-returned-depend-on-how-the-RDD-is-partitioned." class="anchor-link">¶</a></h4>
<h4 id="Instead-of-using-the-collect()-action,-we-can-use-the-take(n)-action-to-return-the-first-n-elements-of-the-RDD.-The-first()-action-returns-the-first-element-of-an-RDD,-and-is-equivalent-to-take(1).">Instead of using the <code>collect()</code> action, we can use the <code>take(n)</code> action to return the first n elements of the RDD. The <code>first()</code> action returns the first element of an RDD, and is equivalent to <code>take(1)</code>.<a href="#Instead-of-using-the-collect%28%29-action,-we-can-use-the-take%28n%29-action-to-return-the-first-n-elements-of-the-RDD.-The-first%28%29-action-returns-the-first-element-of-an-RDD,-and-is-equivalent-to-take%281%29." class="anchor-link">¶</a></h4>
<h4 id="The-takeOrdered()-action-returns-the-first-n-elements-of-the-RDD,-using-either-their-natural-order-or-a-custom-comparator.-The-key-advantage-of-using-takeOrdered()-instead-of-first()-or-take()-is-that-takeOrdered()-returns-a-deterministic-result,-while-the-other-two-actions-may-return-differing-results,-depending-on-the-number-of-partions-or-execution-environment.-takeOrdered()-returns-the-list-sorted-in-ascending-order.--The-top()-action-is-similar-to-takeOrdered()-except-that-it-returns-the-list-in-descending-order.">The <code>takeOrdered()</code>
 action returns the first n elements of the RDD, using either their 
natural order or a custom comparator. The key advantage of using <code>takeOrdered()</code> instead of <code>first()</code> or <code>take()</code> is that <code>takeOrdered()</code>
 returns a deterministic result, while the other two actions may return 
differing results, depending on the number of partions or execution 
environment. <code>takeOrdered()</code> returns the list sorted in <em>ascending order</em>.  The <code>top()</code> action is similar to <code>takeOrdered()</code> except that it returns the list in <em>descending order.</em><a href="#The-takeOrdered%28%29-action-returns-the-first-n-elements-of-the-RDD,-using-either-their-natural-order-or-a-custom-comparator.-The-key-advantage-of-using-takeOrdered%28%29-instead-of-first%28%29-or-take%28%29-is-that-takeOrdered%28%29-returns-a-deterministic-result,-while-the-other-two-actions-may-return-differing-results,-depending-on-the-number-of-partions-or-execution-environment.-takeOrdered%28%29-returns-the-list-sorted-in-ascending-order.--The-top%28%29-action-is-similar-to-takeOrdered%28%29-except-that-it-returns-the-list-in-descending-order." class="anchor-link">¶</a></h4>
<h4 id="The-reduce()-action-reduces-the-elements-of-a-RDD-to-a-single-value-by-applying-a-function-that-takes-two-parameters-and-returns-a-single-value.--The-function-should-be-commutative-and-associative,-as-reduce()-is-applied-at-the-partition-level-and-then-again-to-aggregate-results-from-partitions.--If-these-rules-don't-hold,-the-results-from-reduce()-will-be-inconsistent.--Reducing-locally-at-partitions-makes-reduce()-very-efficient.">The <code>reduce()</code>
 action reduces the elements of a RDD to a single value by applying a 
function that takes two parameters and returns a single value.  The 
function should be commutative and associative, as <code>reduce()</code>
 is applied at the partition level and then again to aggregate results 
from partitions.  If these rules don't hold, the results from <code>reduce()</code> will be inconsistent.  Reducing locally at partitions makes <code>reduce()</code> very efficient.<a href="#The-reduce%28%29-action-reduces-the-elements-of-a-RDD-to-a-single-value-by-applying-a-function-that-takes-two-parameters-and-returns-a-single-value.--The-function-should-be-commutative-and-associative,-as-reduce%28%29-is-applied-at-the-partition-level-and-then-again-to-aggregate-results-from-partitions.--If-these-rules-don%27t-hold,-the-results-from-reduce%28%29-will-be-inconsistent.--Reducing-locally-at-partitions-makes-reduce%28%29-very-efficient." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[69]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6006px; left: 190.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 498.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 184.8px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's get the first element</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">first</span>()</span></pre><pre class=""><span><span class="cm-comment"># The first 4</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">take</span>(<span class="cm-number">4</span>)</span></pre><pre class=""><span><span class="cm-comment"># Note that it is ok to take more elements than the RDD has</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">take</span>(<span class="cm-number">12</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 113px;"></div><div style="display: none; height: 143px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>0
[0, 1, 2, 3]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[70]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 322.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Retrieve the three smallest elements</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeOrdered</span>(<span class="cm-number">3</span>)</span></pre><pre class=""><span><span class="cm-comment"># Retrieve the five largest elements</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">top</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[0, 1, 2]
[9, 8, 7, 6, 5]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[71]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60059px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 507px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Pass a lambda function to takeOrdered to reverse the order</span></span></pre><pre class=""><span><span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeOrdered</span>(<span class="cm-number">4</span>, <span class="cm-keyword">lambda</span> <span class="cm-variable">s</span>: <span class="cm-operator">-</span><span class="cm-variable">s</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt output_prompt">Out[71]:</div><div class="output_subarea output_text output_result"><pre>[9, 8, 7, 6]</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[72]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.6px; left: 140px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 532.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 134.4px; top: 153px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Obtain Python's add function</span></span></pre><pre class=""><span><span class="cm-keyword">from</span> <span class="cm-variable">operator</span> <span class="cm-keyword">import</span> <span class="cm-variable">add</span></span></pre><pre class=""><span><span class="cm-comment"># Efficiently sum the RDD using reduce</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-builtin">reduce</span>(<span class="cm-variable">add</span>)</span></pre><pre class=""><span><span class="cm-comment"># Sum using reduce with a lambda function</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-builtin">reduce</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">a</span>, <span class="cm-variable">b</span>: <span class="cm-variable">a</span> <span class="cm-operator">+</span> <span class="cm-variable">b</span>)</span></pre><pre class=""><span><span class="cm-comment"># Note that subtraction is not both associative and commutative</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-builtin">reduce</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">a</span>, <span class="cm-variable">b</span>: <span class="cm-variable">a</span> <span class="cm-operator">-</span> <span class="cm-variable">b</span>)</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">repartition</span>(<span class="cm-number">4</span>).<span class="cm-builtin">reduce</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">a</span>, <span class="cm-variable">b</span>: <span class="cm-variable">a</span> <span class="cm-operator">-</span> <span class="cm-variable">b</span>)</span></pre><pre class=""><span><span class="cm-comment"># While addition is</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">repartition</span>(<span class="cm-number">4</span>).<span class="cm-builtin">reduce</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">a</span>, <span class="cm-variable">b</span>: <span class="cm-variable">a</span> <span class="cm-operator">+</span> <span class="cm-variable">b</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 198px;"></div><div style="display: none; height: 228px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>45
45
-45
21
45
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 325px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (5b) Advanced actions **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Here are two additional actions that are useful for retrieving information from an RDD: </span><span class="cm-link cm-header cm-header-4">[takeSample()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.takeSample)</span><span class="cm-header cm-header-4"> and </span><span class="cm-link cm-header cm-header-4">[countByValue()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.countByValue)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`takeSample()`</span><span class="cm-header cm-header-4"> action returns an array with a random sample of elements from the dataset.  It takes in a </span><span class="cm-comment cm-header cm-header-4">`withReplacement`</span><span class="cm-header cm-header-4"> argument, which specifies whether it is okay to randomly pick the same item multiple times from the parent RDD (so when </span><span class="cm-comment cm-header cm-header-4">`withReplacement=True`</span><span class="cm-header cm-header-4">, you can get the same item back multiple times). It also takes an optional </span><span class="cm-comment cm-header cm-header-4">`seed`</span><span class="cm-header cm-header-4"> parameter that allows you to specify a seed value for the random number generator, so that reproducible results can be obtained.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`countByValue()`</span><span class="cm-header cm-header-4"> action returns the count of each unique value in the RDD as a dictionary that maps values to counts.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 325px;"></div><div style="display: none; height: 355px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(5b)-Advanced-actions-"><strong> (5b) Advanced actions </strong><a href="#-%285b%29-Advanced-actions-" class="anchor-link">¶</a></h4>
<h4 id="Here-are-two-additional-actions-that-are-useful-for-retrieving-information-from-an-RDD:-takeSample()-and-countByValue()">Here are two additional actions that are useful for retrieving information from an RDD: <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.takeSample">takeSample()</a> and <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.countByValue">countByValue()</a><a href="#Here-are-two-additional-actions-that-are-useful-for-retrieving-information-from-an-RDD:-takeSample%28%29-and-countByValue%28%29" class="anchor-link">¶</a></h4>
<h4 id="The-takeSample()-action-returns-an-array-with-a-random-sample-of-elements-from-the-dataset.--It-takes-in-a-withReplacement-argument,-which-specifies-whether-it-is-okay-to-randomly-pick-the-same-item-multiple-times-from-the-parent-RDD-(so-when-withReplacement=True,-you-can-get-the-same-item-back-multiple-times).-It-also-takes-an-optional-seed-parameter-that-allows-you-to-specify-a-seed-value-for-the-random-number-generator,-so-that-reproducible-results-can-be-obtained.">The <code>takeSample()</code> action returns an array with a random sample of elements from the dataset.  It takes in a <code>withReplacement</code> argument, which specifies whether it is okay to randomly pick the same item multiple times from the parent RDD (so when <code>withReplacement=True</code>, you can get the same item back multiple times). It also takes an optional <code>seed</code>
 parameter that allows you to specify a seed value for the random number
 generator, so that reproducible results can be obtained.<a href="#The-takeSample%28%29-action-returns-an-array-with-a-random-sample-of-elements-from-the-dataset.--It-takes-in-a-withReplacement-argument,-which-specifies-whether-it-is-okay-to-randomly-pick-the-same-item-multiple-times-from-the-parent-RDD-%28so-when-withReplacement=True,-you-can-get-the-same-item-back-multiple-times%29.-It-also-takes-an-optional-seed-parameter-that-allows-you-to-specify-a-seed-value-for-the-random-number-generator,-so-that-reproducible-results-can-be-obtained." class="anchor-link">¶</a></h4>
<h4 id="The-countByValue()-action-returns-the-count-of-each-unique-value-in-the-RDD-as-a-dictionary-that-maps-values-to-counts.">The <code>countByValue()</code> action returns the count of each unique value in the RDD as a dictionary that maps values to counts.<a href="#The-countByValue%28%29-action-returns-the-count-of-each-unique-value-in-the-RDD-as-a-dictionary-that-maps-values-to-counts." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[83]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6006px; left: 249.2px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 498.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 243.6px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># takeSample reusing elements</span></span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeSample</span>(<span class="cm-variable">withReplacement</span>=<span class="cm-builtin">True</span>, <span class="cm-variable">num</span>=<span class="cm-number">6</span>)</span></pre><pre class=""><span><span class="cm-comment"># takeSample without reuse</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeSample</span>(<span class="cm-variable">withReplacement</span>=<span class="cm-builtin">False</span>, <span class="cm-variable">num</span>=<span class="cm-number">6</span>)</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeSample</span>(<span class="cm-variable">withReplacement</span>=<span class="cm-builtin">False</span>, <span class="cm-variable">num</span>=<span class="cm-number">17</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 96px;"></div><div style="display: none; height: 126px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[9, 1, 5, 8, 8, 1]
[8, 5, 9, 7, 2, 0]
[7, 1, 5, 4, 3, 8, 9, 0, 6, 2]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[85]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5996px; left: 182px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 792.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 176.4px; top: 34px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Set seed for predictability</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">takeSample</span>(<span class="cm-variable">withReplacement</span>=<span class="cm-builtin">False</span>, <span class="cm-variable">num</span>=<span class="cm-number">6</span>, <span class="cm-variable">seed</span>=<span class="cm-number">500</span>)</span></pre><pre class=""><span><span class="cm-comment"># Try reruning this cell and the cell above -- the results from this cell will remain constant</span></span></pre><pre class=""><span><span class="cm-comment"># Use ctrl-enter to run without moving to the next cell</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 79px;"></div><div style="display: none; height: 109px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[0, 2, 5, 3, 6, 9]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[86]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6006px; left: 551.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 700.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 546px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Create new base RDD to show countByValue</span></span></pre><pre class=""><span><span class="cm-variable">repetitiveRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>([<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>, <span class="cm-number">4</span>, <span class="cm-number">6</span>])</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">repetitiveRDD</span>.<span class="cm-variable">countByValue</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div style="display: none; height: 92px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>defaultdict(&lt;type 'int'&gt;, {1: 4, 2: 4, 3: 5, 4: 2, 5: 1, 6: 1})
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell unselected rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 32px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 20.35px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">** Part 6: Additional RDD transformations **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 32px;"></div><div style="display: none; height: 62px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="-Part-6:-Additional-RDD-transformations-"><strong> Part 6: Additional RDD transformations </strong><a href="#-Part-6:-Additional-RDD-transformations-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 305px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (6a) </span><span class="cm-strong cm-comment cm-header cm-header-4">`flatMap`</span><span class="cm-strong cm-header cm-header-4"> **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### When performing a </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> transformation using a function, sometimes the function will return more (or less) than one element. We would like the newly created RDD to consist of the elements outputted by the function. Simply applying a </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4"> transformation would yield a new RDD made up of iterators.  Each iterator could have zero or more elements.  Instead, we often want an RDD consisting of the values contained in those iterators.  The solution is to use a </span><span class="cm-link cm-header cm-header-4">[flatMap()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.flatMap)</span><span class="cm-header cm-header-4"> transformation, </span><span class="cm-comment cm-header cm-header-4">`flatMap()`</span><span class="cm-header cm-header-4"> is similar to </span><span class="cm-comment cm-header cm-header-4">`map()`</span><span class="cm-header cm-header-4">, except that with </span><span class="cm-comment cm-header cm-header-4">`flatMap()`</span><span class="cm-header cm-header-4"> each input item can be mapped to zero or more output elements.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To demonstrate </span><span class="cm-comment cm-header cm-header-4">`flatMap()`</span><span class="cm-header cm-header-4">, we will first emit a word along with its plural, and then a range that grows in length with each subsequent operation.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 305px;"></div><div style="display: none; height: 335px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(6a)-flatMap-"><strong> (6a) <code>flatMap</code> </strong><a href="#-%286a%29-flatMap-" class="anchor-link">¶</a></h4>
<h4 id="When-performing-a-map()-transformation-using-a-function,-sometimes-the-function-will-return-more-(or-less)-than-one-element.-We-would-like-the-newly-created-RDD-to-consist-of-the-elements-outputted-by-the-function.-Simply-applying-a-map()-transformation-would-yield-a-new-RDD-made-up-of-iterators.--Each-iterator-could-have-zero-or-more-elements.--Instead,-we-often-want-an-RDD-consisting-of-the-values-contained-in-those-iterators.--The-solution-is-to-use-a-flatMap()-transformation,-flatMap()-is-similar-to-map(),-except-that-with-flatMap()-each-input-item-can-be-mapped-to-zero-or-more-output-elements.">When performing a <code>map()</code>
 transformation using a function, sometimes the function will return 
more (or less) than one element. We would like the newly created RDD to 
consist of the elements outputted by the function. Simply applying a <code>map()</code>
 transformation would yield a new RDD made up of iterators.  Each 
iterator could have zero or more elements.  Instead, we often want an 
RDD consisting of the values contained in those iterators.  The solution
 is to use a <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.flatMap">flatMap()</a> transformation, <code>flatMap()</code> is similar to <code>map()</code>, except that with <code>flatMap()</code> each input item can be mapped to zero or more output elements.<a href="#When-performing-a-map%28%29-transformation-using-a-function,-sometimes-the-function-will-return-more-%28or-less%29-than-one-element.-We-would-like-the-newly-created-RDD-to-consist-of-the-elements-outputted-by-the-function.-Simply-applying-a-map%28%29-transformation-would-yield-a-new-RDD-made-up-of-iterators.--Each-iterator-could-have-zero-or-more-elements.--Instead,-we-often-want-an-RDD-consisting-of-the-values-contained-in-those-iterators.--The-solution-is-to-use-a-flatMap%28%29-transformation,-flatMap%28%29-is-similar-to-map%28%29,-except-that-with-flatMap%28%29-each-input-item-can-be-mapped-to-zero-or-more-output-elements." class="anchor-link">¶</a></h4>
<h4 id="To-demonstrate-flatMap(),-we-will-first-emit-a-word-along-with-its-plural,-and-then-a-range-that-grows-in-length-with-each-subsequent-operation.">To demonstrate <code>flatMap()</code>, we will first emit a word along with its plural, and then a range that grows in length with each subsequent operation.<a href="#To-demonstrate-flatMap%28%29,-we-will-first-emit-a-word-along-with-its-plural,-and-then-a-range-that-grows-in-length-with-each-subsequent-operation." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[88]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 243.6px; left: 333.2px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px; bottom: 0px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 574.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 327.6px; top: 238px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Let's create a new base RDD to work from</span></span></pre><pre class=""><span><span class="cm-variable">wordsList</span> = [<span class="cm-string">'cat'</span>, <span class="cm-string">'elephant'</span>, <span class="cm-string">'rat'</span>, <span class="cm-string">'rat'</span>, <span class="cm-string">'cat'</span>]</span></pre><pre class=""><span><span class="cm-variable">wordsRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>(<span class="cm-variable">wordsList</span>, <span class="cm-number">4</span>)</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># Use map</span></span></pre><pre class=""><span><span class="cm-variable">singularAndPluralWordsRDDMap</span> = <span class="cm-variable">wordsRDD</span>.<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span>, <span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-string">'s'</span>))</span></pre><pre class=""><span><span class="cm-comment"># Use flatMap</span></span></pre><pre class=""><span><span class="cm-variable">singularAndPluralWordsRDD</span> = <span class="cm-variable">wordsRDD</span>.<span class="cm-variable">flatMap</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: (<span class="cm-variable">x</span>, <span class="cm-variable">x</span> <span class="cm-operator">+</span> <span class="cm-string">'s'</span>))</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># View the results</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">singularAndPluralWordsRDDMap</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">singularAndPluralWordsRDD</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-comment"># View the number of elements in the RDD</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">singularAndPluralWordsRDDMap</span>.<span class="cm-variable">count</span>()</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">singularAndPluralWordsRDD</span>.<span class="cm-variable">count</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 266px;"></div><div style="display: none; height: 296px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[('cat', 'cats'), ('elephant', 'elephants'), ('rat', 'rats'), ('rat', 'rats'), ('cat', 'cats')]
['cat', 'cats', 'elephant', 'elephants', 'rat', 'rats', 'rat', 'rats', 'cat', 'cats']
5
10
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[92]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.6001px; left: 350px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">, 2</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 473.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 344.4px; top: 51px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-variable">simpleRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>([<span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>])</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">simpleRDD</span>.<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">range</span>(<span class="cm-number">1</span>, <span class="cm-variable">x</span>)).<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">simpleRDD</span>.<span class="cm-variable">flatMap</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">range</span>(<span class="cm-number">1</span>, <span class="cm-variable">x</span>)).<span class="cm-variable">collect</span>()</span></pre><pre><span><span class="cm-variable">simple_rdd_2</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>([<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">2</span>])</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">simple_rdd_2</span>.<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: [<span class="cm-variable">x</span>, <span class="cm-variable">x</span><span class="cm-operator">+</span><span class="cm-number">5</span>]).<span class="cm-variable">collect</span>()</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">simple_rdd_2</span>.<span class="cm-variable">flatMap</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: [<span class="cm-variable">x</span>, <span class="cm-variable">x</span><span class="cm-operator">+</span><span class="cm-number">5</span>]).<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 113px;"></div><div style="display: none; height: 143px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[[1], [1, 2], [1, 2, 3]]
[1, 1, 2, 1, 2, 3]
[[1, 6], [2, 7], [3, 8], [2, 7]]
[1, 6, 2, 7, 3, 8, 2, 7]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 1101px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (6b) </span><span class="cm-strong cm-comment cm-header cm-header-4">`groupByKey`</span><span class="cm-strong cm-header cm-header-4"> and </span><span class="cm-strong cm-comment cm-header cm-header-4">`reduceByKey`</span><span class="cm-strong cm-header cm-header-4"> **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Let's investigate the additional transformations: </span><span class="cm-link cm-header cm-header-4">[groupByKey()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.groupByKey)</span><span class="cm-header cm-header-4"> and </span><span class="cm-link cm-header cm-header-4">[reduceByKey()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.reduceByKey)</span><span class="cm-header cm-header-4">.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Both of these transformations operate on pair RDDs.  A pair RDD is an RDD where each element is a pair tuple (key, value).  For example, </span><span class="cm-comment cm-header cm-header-4">`sc.parallelize([('a', 1), ('a', 2), ('b', 1)])`</span><span class="cm-header cm-header-4"> would create a pair RDD where the keys are 'a', 'a', 'b' and the values are 1, 2, 1.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> transformation gathers together pairs that have the same key and applies a function to two associated values at a time. </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> operates by applying the function first within each partition on a per-key basis and then across the partitions.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### While both the </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4"> and </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> transformations can often be used to solve the same problem and will produce the same answer, the </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> transformation works much better for large distributed datasets. This is because Spark knows it can combine output with a common key on each partition </span><span class="cm-em cm-header cm-header-4">*before*</span><span class="cm-header cm-header-4"> shuffling (redistributing) the data across nodes.  Only use </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4"> if the operation would not benefit from reducing the data before the shuffle occurs.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Look at the diagram below to understand how </span><span class="cm-comment cm-header cm-header-4">`reduceByKey`</span><span class="cm-header cm-header-4"> works.  Notice how pairs on the same machine with the same key are combined (by using the lamdba function passed into reduceByKey) before the data is shuffled. Then the lamdba function is called again to reduce all the values from each partition to produce one final result.</span></span></pre><pre class=""><span><span class="cm-tag">![reduceByKey() figure]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/reduce_by.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### On the other hand, when using the </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4"> transformation - all the key-value pairs are shuffled around, causing a lot of unnecessary data to being transferred over the network.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To determine which machine to shuffle a pair to, Spark calls a partitioning function on the key of the pair. Spark spills data to disk when there is more data shuffled onto a single executor machine than can fit in memory. However, it flushes out the data to disk one key at a time, so if a single key has more key-value pairs than can fit in memory an out of memory exception occurs. This will be more gracefully handled in a later release of Spark so that the job can still proceed, but should still be avoided.  When Spark needs to spill to disk, performance is severely impacted.</span></span></pre><pre class=""><span><span class="cm-tag">![groupByKey() figure]</span><span class="cm-string">(http://spark-mooc.github.io/web-assets/images/group_by.png)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### As your dataset grows, the difference in the amount of data that needs to be shuffled, between the </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> and </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4"> transformations, becomes increasingly exaggerated.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Here are more transformations to prefer over </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4">:</span></span></pre><pre class=""><span>  <span class="cm-variable-2">+ #### </span><span class="cm-link cm-variable-2">[combineByKey()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.combineByKey)</span><span class="cm-variable-2"> can be used when you are combining elements but your return type differs from your input value type.</span></span></pre><pre class=""><span>  <span class="cm-variable-2">+ #### </span><span class="cm-link cm-variable-2">[foldByKey()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.foldByKey)</span><span class="cm-variable-2"> merges the values for each key using an associative function and a neutral "zero value".</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Now let's go through a simple </span><span class="cm-comment cm-header cm-header-4">`groupByKey()`</span><span class="cm-header cm-header-4"> and </span><span class="cm-comment cm-header cm-header-4">`reduceByKey()`</span><span class="cm-header cm-header-4"> example.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 1101px;"></div><div style="display: none; height: 1131px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(6b)-groupByKey-and-reduceByKey-"><strong> (6b) <code>groupByKey</code> and <code>reduceByKey</code> </strong><a href="#-%286b%29-groupByKey-and-reduceByKey-" class="anchor-link">¶</a></h4>
<h4 id="Let's-investigate-the-additional-transformations:-groupByKey()-and-reduceByKey().">Let's investigate the additional transformations: <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.groupByKey">groupByKey()</a> and <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.reduceByKey">reduceByKey()</a>.<a href="#Let%27s-investigate-the-additional-transformations:-groupByKey%28%29-and-reduceByKey%28%29." class="anchor-link">¶</a></h4>
<h4 id="Both-of-these-transformations-operate-on-pair-RDDs.--A-pair-RDD-is-an-RDD-where-each-element-is-a-pair-tuple-(key,-value).--For-example,-sc.parallelize([('a',-1),-('a',-2),-('b',-1)])-would-create-a-pair-RDD-where-the-keys-are-'a',-'a',-'b'-and-the-values-are-1,-2,-1.">Both
 of these transformations operate on pair RDDs.  A pair RDD is an RDD 
where each element is a pair tuple (key, value).  For example, <code>sc.parallelize([('a', 1), ('a', 2), ('b', 1)])</code> would create a pair RDD where the keys are 'a', 'a', 'b' and the values are 1, 2, 1.<a href="#Both-of-these-transformations-operate-on-pair-RDDs.--A-pair-RDD-is-an-RDD-where-each-element-is-a-pair-tuple-%28key,-value%29.--For-example,-sc.parallelize%28[%28%27a%27,-1%29,-%28%27a%27,-2%29,-%28%27b%27,-1%29]%29-would-create-a-pair-RDD-where-the-keys-are-%27a%27,-%27a%27,-%27b%27-and-the-values-are-1,-2,-1." class="anchor-link">¶</a></h4>
<h4 id="The-reduceByKey()-transformation-gathers-together-pairs-that-have-the-same-key-and-applies-a-function-to-two-associated-values-at-a-time.-reduceByKey()-operates-by-applying-the-function-first-within-each-partition-on-a-per-key-basis-and-then-across-the-partitions.">The <code>reduceByKey()</code> transformation gathers together pairs that have the same key and applies a function to two associated values at a time. <code>reduceByKey()</code> operates by applying the function first within each partition on a per-key basis and then across the partitions.<a href="#The-reduceByKey%28%29-transformation-gathers-together-pairs-that-have-the-same-key-and-applies-a-function-to-two-associated-values-at-a-time.-reduceByKey%28%29-operates-by-applying-the-function-first-within-each-partition-on-a-per-key-basis-and-then-across-the-partitions." class="anchor-link">¶</a></h4>
<h4 id="While-both-the-groupByKey()-and-reduceByKey()-transformations-can-often-be-used-to-solve-the-same-problem-and-will-produce-the-same-answer,-the-reduceByKey()-transformation-works-much-better-for-large-distributed-datasets.-This-is-because-Spark-knows-it-can-combine-output-with-a-common-key-on-each-partition-before-shuffling-(redistributing)-the-data-across-nodes.--Only-use-groupByKey()-if-the-operation-would-not-benefit-from-reducing-the-data-before-the-shuffle-occurs.">While both the <code>groupByKey()</code> and <code>reduceByKey()</code> transformations can often be used to solve the same problem and will produce the same answer, the <code>reduceByKey()</code>
 transformation works much better for large distributed datasets. This 
is because Spark knows it can combine output with a common key on each 
partition <em>before</em> shuffling (redistributing) the data across nodes.  Only use <code>groupByKey()</code> if the operation would not benefit from reducing the data before the shuffle occurs.<a href="#While-both-the-groupByKey%28%29-and-reduceByKey%28%29-transformations-can-often-be-used-to-solve-the-same-problem-and-will-produce-the-same-answer,-the-reduceByKey%28%29-transformation-works-much-better-for-large-distributed-datasets.-This-is-because-Spark-knows-it-can-combine-output-with-a-common-key-on-each-partition-before-shuffling-%28redistributing%29-the-data-across-nodes.--Only-use-groupByKey%28%29-if-the-operation-would-not-benefit-from-reducing-the-data-before-the-shuffle-occurs." class="anchor-link">¶</a></h4>
<h4 id="Look-at-the-diagram-below-to-understand-how-reduceByKey-works.--Notice-how-pairs-on-the-same-machine-with-the-same-key-are-combined-(by-using-the-lamdba-function-passed-into-reduceByKey)-before-the-data-is-shuffled.-Then-the-lamdba-function-is-called-again-to-reduce-all-the-values-from-each-partition-to-produce-one-final-result.">Look at the diagram below to understand how <code>reduceByKey</code>
 works.  Notice how pairs on the same machine with the same key are 
combined (by using the lamdba function passed into reduceByKey) before 
the data is shuffled. Then the lamdba function is called again to reduce
 all the values from each partition to produce one final result.<a href="#Look-at-the-diagram-below-to-understand-how-reduceByKey-works.--Notice-how-pairs-on-the-same-machine-with-the-same-key-are-combined-%28by-using-the-lamdba-function-passed-into-reduceByKey%29-before-the-data-is-shuffled.-Then-the-lamdba-function-is-called-again-to-reduce-all-the-values-from-each-partition-to-produce-one-final-result." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/reduce_by.png" alt="reduceByKey() figure"></p>
<h4 id="On-the-other-hand,-when-using-the-groupByKey()-transformation---all-the-key-value-pairs-are-shuffled-around,-causing-a-lot-of-unnecessary-data-to-being-transferred-over-the-network.">On the other hand, when using the <code>groupByKey()</code>
 transformation - all the key-value pairs are shuffled around, causing a
 lot of unnecessary data to being transferred over the network.<a href="#On-the-other-hand,-when-using-the-groupByKey%28%29-transformation---all-the-key-value-pairs-are-shuffled-around,-causing-a-lot-of-unnecessary-data-to-being-transferred-over-the-network." class="anchor-link">¶</a></h4>
<h4 id="To-determine-which-machine-to-shuffle-a-pair-to,-Spark-calls-a-partitioning-function-on-the-key-of-the-pair.-Spark-spills-data-to-disk-when-there-is-more-data-shuffled-onto-a-single-executor-machine-than-can-fit-in-memory.-However,-it-flushes-out-the-data-to-disk-one-key-at-a-time,-so-if-a-single-key-has-more-key-value-pairs-than-can-fit-in-memory-an-out-of-memory-exception-occurs.-This-will-be-more-gracefully-handled-in-a-later-release-of-Spark-so-that-the-job-can-still-proceed,-but-should-still-be-avoided.--When-Spark-needs-to-spill-to-disk,-performance-is-severely-impacted.">To
 determine which machine to shuffle a pair to, Spark calls a 
partitioning function on the key of the pair. Spark spills data to disk 
when there is more data shuffled onto a single executor machine than can
 fit in memory. However, it flushes out the data to disk one key at a 
time, so if a single key has more key-value pairs than can fit in memory
 an out of memory exception occurs. This will be more gracefully handled
 in a later release of Spark so that the job can still proceed, but 
should still be avoided.  When Spark needs to spill to disk, performance
 is severely impacted.<a href="#To-determine-which-machine-to-shuffle-a-pair-to,-Spark-calls-a-partitioning-function-on-the-key-of-the-pair.-Spark-spills-data-to-disk-when-there-is-more-data-shuffled-onto-a-single-executor-machine-than-can-fit-in-memory.-However,-it-flushes-out-the-data-to-disk-one-key-at-a-time,-so-if-a-single-key-has-more-key-value-pairs-than-can-fit-in-memory-an-out-of-memory-exception-occurs.-This-will-be-more-gracefully-handled-in-a-later-release-of-Spark-so-that-the-job-can-still-proceed,-but-should-still-be-avoided.--When-Spark-needs-to-spill-to-disk,-performance-is-severely-impacted." class="anchor-link">¶</a></h4>
<p><img src="spark_tutorial_student.read-only_files/group_by.png" alt="groupByKey() figure"></p>
<h4 id="As-your-dataset-grows,-the-difference-in-the-amount-of-data-that-needs-to-be-shuffled,-between-the-reduceByKey()-and-groupByKey()-transformations,-becomes-increasingly-exaggerated.">As your dataset grows, the difference in the amount of data that needs to be shuffled, between the <code>reduceByKey()</code> and <code>groupByKey()</code> transformations, becomes increasingly exaggerated.<a href="#As-your-dataset-grows,-the-difference-in-the-amount-of-data-that-needs-to-be-shuffled,-between-the-reduceByKey%28%29-and-groupByKey%28%29-transformations,-becomes-increasingly-exaggerated." class="anchor-link">¶</a></h4>
<h4 id="Here-are-more-transformations-to-prefer-over-groupByKey():">Here are more transformations to prefer over <code>groupByKey()</code>:<a href="#Here-are-more-transformations-to-prefer-over-groupByKey%28%29:" class="anchor-link">¶</a></h4>
<ul>
<li><h4 id="combineByKey()-can-be-used-when-you-are-combining-elements-but-your-return-type-differs-from-your-input-value-type."><a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.combineByKey">combineByKey()</a> can be used when you are combining elements but your return type differs from your input value type.<a href="#combineByKey%28%29-can-be-used-when-you-are-combining-elements-but-your-return-type-differs-from-your-input-value-type." class="anchor-link">¶</a></h4>
</li>
<li><h4 id="foldByKey()-merges-the-values-for-each-key-using-an-associative-function-and-a-neutral-&quot;zero-value&quot;."><a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.foldByKey">foldByKey()</a> merges the values for each key using an associative function and a neutral "zero value".<a href="#foldByKey%28%29-merges-the-values-for-each-key-using-an-associative-function-and-a-neutral-%22zero-value%22." class="anchor-link">¶</a></h4>
<h4 id="Now-let's-go-through-a-simple-groupByKey()-and-reduceByKey()-example.">Now let's go through a simple <code>groupByKey()</code> and <code>reduceByKey()</code> example.<a href="#Now-let%27s-go-through-a-simple-groupByKey%28%29-and-reduceByKey%28%29-example." class="anchor-link">¶</a></h4>
</li>
</ul>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[94]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.6px; left: 341.6px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 574.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 336px; top: 153px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-variable">pairRDD</span> = <span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>([(<span class="cm-string">'a'</span>, <span class="cm-number">1</span>), (<span class="cm-string">'a'</span>, <span class="cm-number">2</span>), (<span class="cm-string">'b'</span>, <span class="cm-number">1</span>)])</span></pre><pre class=""><span><span class="cm-comment"># mapValues only used to improve format for printing</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">pairRDD</span>.<span class="cm-variable">groupByKey</span>().<span class="cm-variable">mapValues</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">list</span>(<span class="cm-variable">x</span>)).<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># Different ways to sum by key</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">pairRDD</span>.<span class="cm-variable">groupByKey</span>().<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> (<span class="cm-variable">k</span>, <span class="cm-variable">v</span>): (<span class="cm-variable">k</span>, <span class="cm-builtin">sum</span>(<span class="cm-variable">v</span>))).<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-comment"># Using mapValues, which is recommended when they key doesn't change</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">pairRDD</span>.<span class="cm-variable">groupByKey</span>().<span class="cm-variable">mapValues</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">sum</span>(<span class="cm-variable">x</span>)).<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-comment"># reduceByKey is more efficient / scalable</span></span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">pairRDD</span>.<span class="cm-variable">reduceByKey</span>(<span class="cm-variable">add</span>).<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 181px;"></div><div style="display: none; height: 211px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[('a', [1, 2]), ('b', [1])]
[('a', 3), ('b', 1)]
[('a', 3), ('b', 1)]
[('a', 3), ('b', 1)]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 303px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (6c) Advanced transformations **</span><span class="cm-header cm-header-4"> [Optional]</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Let's investigate the advanced transformations: </span><span class="cm-link cm-header cm-header-4">[mapPartitions()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.mapPartitions)</span><span class="cm-header cm-header-4"> and </span><span class="cm-link cm-header cm-header-4">[mapPartitionsWithIndex()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.mapPartitionsWithIndex)</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`mapPartitions()`</span><span class="cm-header cm-header-4"> transformation uses a function that takes in an iterator (to the items in that specific partition) and returns an iterator.  The function is applied on a partition by partition basis.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`mapPartitionsWithIndex()`</span><span class="cm-header cm-header-4"> transformation uses a function that takes in a partition index (think of this like the partition number) and an iterator (to the items in that specific partition). For every partition (index, iterator) pair, the function returns a tuple of the same partition index number and an iterator of the transformed items in that partition.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 303px;"></div><div style="display: none; height: 333px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(6c)-Advanced-transformations--[Optional]"><strong> (6c) Advanced transformations </strong> [Optional]<a href="#-%286c%29-Advanced-transformations--[Optional]" class="anchor-link">¶</a></h4>
<h4 id="Let's-investigate-the-advanced-transformations:-mapPartitions()-and-mapPartitionsWithIndex()">Let's investigate the advanced transformations: <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.mapPartitions">mapPartitions()</a> and <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.mapPartitionsWithIndex">mapPartitionsWithIndex()</a><a href="#Let%27s-investigate-the-advanced-transformations:-mapPartitions%28%29-and-mapPartitionsWithIndex%28%29" class="anchor-link">¶</a></h4>
<h4 id="The-mapPartitions()-transformation-uses-a-function-that-takes-in-an-iterator-(to-the-items-in-that-specific-partition)-and-returns-an-iterator.--The-function-is-applied-on-a-partition-by-partition-basis.">The <code>mapPartitions()</code>
 transformation uses a function that takes in an iterator (to the items 
in that specific partition) and returns an iterator.  The function is 
applied on a partition by partition basis.<a href="#The-mapPartitions%28%29-transformation-uses-a-function-that-takes-in-an-iterator-%28to-the-items-in-that-specific-partition%29-and-returns-an-iterator.--The-function-is-applied-on-a-partition-by-partition-basis." class="anchor-link">¶</a></h4>
<h4 id="The-mapPartitionsWithIndex()-transformation-uses-a-function-that-takes-in-a-partition-index-(think-of-this-like-the-partition-number)-and-an-iterator-(to-the-items-in-that-specific-partition).-For-every-partition-(index,-iterator)-pair,-the-function-returns-a-tuple-of-the-same-partition-index-number-and-an-iterator-of-the-transformed-items-in-that-partition.">The <code>mapPartitionsWithIndex()</code>
 transformation uses a function that takes in a partition index (think 
of this like the partition number) and an iterator (to the items in that
 specific partition). For every partition (index, iterator) pair, the 
function returns a tuple of the same partition index number and an 
iterator of the transformed items in that partition.<a href="#The-mapPartitionsWithIndex%28%29-transformation-uses-a-function-that-takes-in-a-partition-index-%28think-of-this-like-the-partition-number%29-and-an-iterator-%28to-the-items-in-that-specific-partition%29.-For-every-partition-%28index,-iterator%29-pair,-the-function-returns-a-tuple-of-the-same-partition-index-number-and-an-iterator-of-the-transformed-items-in-that-partition." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[98]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 124.6px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 666.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 147px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 0px; top: 119px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">wordsRDD</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-comment"># ['cat', 'elephant', 'rat', 'rat', 'cat']</span></span></pre><pre class=""><span><span class="cm-variable">wordsRDD</span>.<span class="cm-variable">getNumPartitions</span>()</span></pre><pre><span><span class="cm-comment"># 4</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-comment"># mapPartitions takes a function that takes an iterator and returns an iterator</span></span></pre><pre class=""><span><span class="cm-variable">itemsRDD</span> = <span class="cm-variable">wordsRDD</span>.<span class="cm-variable">mapPartitions</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">iterator</span>: [<span class="cm-string">','</span>.<span class="cm-variable">join</span>(<span class="cm-variable">iterator</span>)])</span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">itemsRDD</span>.<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 147px;"></div><div style="display: none; height: 177px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>['cat', 'elephant', 'rat', 'rat', 'cat']
['cat', 'elephant', 'rat', 'rat,cat']
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[99]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 834.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-variable">itemsByPartRDD</span> = <span class="cm-variable">wordsRDD</span>.<span class="cm-variable">mapPartitionsWithIndex</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">index</span>, <span class="cm-variable">iterator</span>: [(<span class="cm-variable">index</span>, <span class="cm-builtin">list</span>(<span class="cm-variable">iterator</span>))])</span></pre><pre class=""><span><span class="cm-comment"># We can see that three of the (partitions) workers have one element and the fourth worker has two</span></span></pre><pre class=""><span><span class="cm-comment"># elements, although things may not bode well for the rat...</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">itemsByPartRDD</span>.<span class="cm-variable">collect</span>()</span></pre><pre class=""><span><span class="cm-comment"># Rerun without returning a list (acts more like flatMap)</span></span></pre><pre class=""><span><span class="cm-variable">itemsByPartRDD</span> = <span class="cm-variable">wordsRDD</span>.<span class="cm-variable">mapPartitionsWithIndex</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">index</span>, <span class="cm-variable">iterator</span>: (<span class="cm-variable">index</span>, <span class="cm-builtin">list</span>(<span class="cm-variable">iterator</span>)))</span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">itemsByPartRDD</span>.<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 130px;"></div><div style="display: none; height: 160px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[(0, ['cat']), (1, ['elephant']), (2, ['rat']), (3, ['rat', 'cat'])]
[0, ['cat'], 1, ['elephant'], 2, ['rat'], 3, ['rat', 'cat']]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 32px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 20.35px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">** Part 7: Caching RDDs and storage options **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 32px;"></div><div style="display: none; height: 62px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="-Part-7:-Caching-RDDs-and-storage-options-"><strong> Part 7: Caching RDDs and storage options </strong><a href="#-Part-7:-Caching-RDDs-and-storage-options-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 106px; left: 215.617px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 189px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 210.017px; top: 100.4px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (7a) Caching RDDs **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### For efficiency Spark keeps your RDDs in memory. By keeping the contents in memory, Spark can quickly access the data. However, memory is limited, so if you try to keep too many RDDs in memory, Spark will automatically delete RDDs from memory to make space for new RDDs. If you later refer to one of the RDDs, Spark will automatically recreate the RDD for you, but that takes time.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### So, if you plan to use an RDD more than once, then you should tell Spark to cache that RDD. You can use the </span><span class="cm-comment cm-header cm-header-4">`cache()`</span><span class="cm-header cm-header-4"> operation to keep the RDD in memory. However, if you cache too many RDDs and Spark runs out of memory, it will delete the least recently used (LRU) RDD first. Again, the RDD will be automatically recreated when accessed.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### You can check if an RDD is cached by using the </span><span class="cm-comment cm-header cm-header-4">`is_cached`</span><span class="cm-header cm-header-4"> attribute, and you can see your cached RDD in the "Storage" section of the Spark web UI. If you click on the RDD's name, you can see more information about where the RDD is stored.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 189px;"></div><div style="display: none; height: 219px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(7a)-Caching-RDDs-"><strong> (7a) Caching RDDs </strong><a href="#-%287a%29-Caching-RDDs-" class="anchor-link">¶</a></h4>
<h4 id="For-efficiency-Spark-keeps-your-RDDs-in-memory.-By-keeping-the-contents-in-memory,-Spark-can-quickly-access-the-data.-However,-memory-is-limited,-so-if-you-try-to-keep-too-many-RDDs-in-memory,-Spark-will-automatically-delete-RDDs-from-memory-to-make-space-for-new-RDDs.-If-you-later-refer-to-one-of-the-RDDs,-Spark-will-automatically-recreate-the-RDD-for-you,-but-that-takes-time.">For
 efficiency Spark keeps your RDDs in memory. By keeping the contents in 
memory, Spark can quickly access the data. However, memory is limited, 
so if you try to keep too many RDDs in memory, Spark will automatically 
delete RDDs from memory to make space for new RDDs. If you later refer 
to one of the RDDs, Spark will automatically recreate the RDD for you, 
but that takes time.<a href="#For-efficiency-Spark-keeps-your-RDDs-in-memory.-By-keeping-the-contents-in-memory,-Spark-can-quickly-access-the-data.-However,-memory-is-limited,-so-if-you-try-to-keep-too-many-RDDs-in-memory,-Spark-will-automatically-delete-RDDs-from-memory-to-make-space-for-new-RDDs.-If-you-later-refer-to-one-of-the-RDDs,-Spark-will-automatically-recreate-the-RDD-for-you,-but-that-takes-time." class="anchor-link">¶</a></h4>
<h4 id="So,-if-you-plan-to-use-an-RDD-more-than-once,-then-you-should-tell-Spark-to-cache-that-RDD.-You-can-use-the-cache()-operation-to-keep-the-RDD-in-memory.-However,-if-you-cache-too-many-RDDs-and-Spark-runs-out-of-memory,-it-will-delete-the-least-recently-used-(LRU)-RDD-first.-Again,-the-RDD-will-be-automatically-recreated-when-accessed.">So, if you plan to use an RDD more than once, then you should tell Spark to cache that RDD. You can use the <code>cache()</code>
 operation to keep the RDD in memory. However, if you cache too many 
RDDs and Spark runs out of memory, it will delete the least recently 
used (LRU) RDD first. Again, the RDD will be automatically recreated 
when accessed.<a href="#So,-if-you-plan-to-use-an-RDD-more-than-once,-then-you-should-tell-Spark-to-cache-that-RDD.-You-can-use-the-cache%28%29-operation-to-keep-the-RDD-in-memory.-However,-if-you-cache-too-many-RDDs-and-Spark-runs-out-of-memory,-it-will-delete-the-least-recently-used-%28LRU%29-RDD-first.-Again,-the-RDD-will-be-automatically-recreated-when-accessed." class="anchor-link">¶</a></h4>
<h4 id="You-can-check-if-an-RDD-is-cached-by-using-the-is_cached-attribute,-and-you-can-see-your-cached-RDD-in-the-&quot;Storage&quot;-section-of-the-Spark-web-UI.-If-you-click-on-the-RDD's-name,-you-can-see-more-information-about-where-the-RDD-is-stored.">You can check if an RDD is cached by using the <code>is_cached</code>
 attribute, and you can see your cached RDD in the "Storage" section of 
the Spark web UI. If you click on the RDD's name, you can see more 
information about where the RDD is stored.<a href="#You-can-check-if-an-RDD-is-cached-by-using-the-is_cached-attribute,-and-you-can-see-your-cached-RDD-in-the-%22Storage%22-section-of-the-Spark-web-UI.-If-you-click-on-the-RDD%27s-name,-you-can-see-more-information-about-where-the-RDD-is-stored." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[100]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5999px; left: 64.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 322.2px; margin-bottom: 0px; border-right-width: 30px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="" class="CodeMirror-cursors"><div style="left: 58.8px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Name the RDD</span></span></pre><pre class=""><span><span class="cm-variable">filteredRDD</span>.<span class="cm-variable">setName</span>(<span class="cm-string">'My Filtered RDD'</span>)</span></pre><pre class=""><span><span class="cm-comment"># Cache the RDD</span></span></pre><pre class=""><span><span class="cm-variable">filteredRDD</span>.<span class="cm-variable">cache</span>()</span></pre><pre class=""><span><span class="cm-comment"># Is it cached</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">is_cached</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 113px;"></div><div style="display: none; height: 143px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>True
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 385px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (7b) Unpersist and storage options **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Spark automatically manages the RDDs cached in memory and will save them to disk if it runs out of memory. For efficiency, once you are finished using an RDD, you can optionally tell Spark to stop caching it in memory by using the RDD's </span><span class="cm-comment cm-header cm-header-4">`unpersist()`</span><span class="cm-header cm-header-4"> method to inform Spark that you no longer need the RDD in memory.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### You can see the set of transformations that were applied to create an RDD by using the </span><span class="cm-comment cm-header cm-header-4">`toDebugString()`</span><span class="cm-header cm-header-4"> method, which will provide storage information, and you can directly query the current storage information for an RDD using the </span><span class="cm-comment cm-header cm-header-4">`getStorageLevel()`</span><span class="cm-header cm-header-4"> operation.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** Advanced: **</span><span class="cm-header cm-header-4"> Spark provides many more options for managing how RDDs are stored in memory or even saved to disk. You can explore the API for RDD's </span><span class="cm-link cm-header cm-header-4">[persist()]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.persist)</span><span class="cm-header cm-header-4"> operation using Python's </span><span class="cm-link cm-header cm-header-4">[help()]</span><span class="cm-string">(https://docs.python.org/2/library/functions.html?highlight=help#help)</span><span class="cm-header cm-header-4"> command.  The </span><span class="cm-comment cm-header cm-header-4">`persist()`</span><span class="cm-header cm-header-4"> operation, optionally, takes a pySpark </span><span class="cm-link cm-header cm-header-4">[StorageLevel]</span><span class="cm-string">(http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.StorageLevel)</span><span class="cm-header cm-header-4"> object.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 385px;"></div><div style="display: none; height: 415px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(7b)-Unpersist-and-storage-options-"><strong> (7b) Unpersist and storage options </strong><a href="#-%287b%29-Unpersist-and-storage-options-" class="anchor-link">¶</a></h4>
<h4 id="Spark-automatically-manages-the-RDDs-cached-in-memory-and-will-save-them-to-disk-if-it-runs-out-of-memory.-For-efficiency,-once-you-are-finished-using-an-RDD,-you-can-optionally-tell-Spark-to-stop-caching-it-in-memory-by-using-the-RDD's-unpersist()-method-to-inform-Spark-that-you-no-longer-need-the-RDD-in-memory.">Spark
 automatically manages the RDDs cached in memory and will save them to 
disk if it runs out of memory. For efficiency, once you are finished 
using an RDD, you can optionally tell Spark to stop caching it in memory
 by using the RDD's <code>unpersist()</code> method to inform Spark that you no longer need the RDD in memory.<a href="#Spark-automatically-manages-the-RDDs-cached-in-memory-and-will-save-them-to-disk-if-it-runs-out-of-memory.-For-efficiency,-once-you-are-finished-using-an-RDD,-you-can-optionally-tell-Spark-to-stop-caching-it-in-memory-by-using-the-RDD%27s-unpersist%28%29-method-to-inform-Spark-that-you-no-longer-need-the-RDD-in-memory." class="anchor-link">¶</a></h4>
<h4 id="You-can-see-the-set-of-transformations-that-were-applied-to-create-an-RDD-by-using-the-toDebugString()-method,-which-will-provide-storage-information,-and-you-can-directly-query-the-current-storage-information-for-an-RDD-using-the-getStorageLevel()-operation.">You can see the set of transformations that were applied to create an RDD by using the <code>toDebugString()</code>
 method, which will provide storage information, and you can directly 
query the current storage information for an RDD using the <code>getStorageLevel()</code> operation.<a href="#You-can-see-the-set-of-transformations-that-were-applied-to-create-an-RDD-by-using-the-toDebugString%28%29-method,-which-will-provide-storage-information,-and-you-can-directly-query-the-current-storage-information-for-an-RDD-using-the-getStorageLevel%28%29-operation." class="anchor-link">¶</a></h4>
<h4 id="-Advanced:--Spark-provides-many-more-options-for-managing-how-RDDs-are-stored-in-memory-or-even-saved-to-disk.-You-can-explore-the-API-for-RDD's-persist()-operation-using-Python's-help()-command.--The-persist()-operation,-optionally,-takes-a-pySpark-StorageLevel-object."><strong> Advanced: </strong>
 Spark provides many more options for managing how RDDs are stored in 
memory or even saved to disk. You can explore the API for RDD's <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.RDD.persist">persist()</a> operation using Python's <a target="_blank" href="https://docs.python.org/2/library/functions.html?highlight=help#help">help()</a> command.  The <code>persist()</code> operation, optionally, takes a pySpark <a target="_blank" href="http://spark.apache.org/docs/latest/api/python/pyspark.html#pyspark.StorageLevel">StorageLevel</a> object.<a href="#-Advanced:--Spark-provides-many-more-options-for-managing-how-RDDs-are-stored-in-memory-or-even-saved-to-disk.-You-can-explore-the-API-for-RDD%27s-persist%28%29-operation-using-Python%27s-help%28%29-command.--The-persist%28%29-operation,-optionally,-takes-a-pySpark-StorageLevel-object." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[101]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6001px; left: 282.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 498.6px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 277.2px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Note that toDebugString also provides storage information</span></span></pre><pre><span><span class="cm-keyword">print</span> <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">toDebugString</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>(8) My Filtered RDD PythonRDD[33] at collect at &lt;ipython-input-64-2e6525e1a0c2&gt;:23 [Memory Serialized 1x Replicated]
 |  ParallelCollectionRDD[0] at parallelize at PythonRDD.scala:392 [Memory Serialized 1x Replicated]
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[107]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.6001px; left: 106.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 717px; margin-bottom: 0px; border-right-width: 30px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 100.8px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># If we are done with the RDD we can unpersist it so that its memory can be reclaimed</span></span></pre><pre class=""><span><span class="cm-variable">filteredRDD</span>.<span class="cm-variable">unpersist</span>()</span></pre><pre class=""><span><span class="cm-comment"># Storage level for a non cached RDD</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">"Storage level for a non cached RDD: "</span>, <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">getStorageLevel</span>()</span></pre><pre class=""><span><span class="cm-variable">filteredRDD</span>.<span class="cm-variable">cache</span>()</span></pre><pre class=""><span><span class="cm-comment"># Storage level for a cached RDD</span></span></pre><pre class=""><span><span class="cm-keyword">print</span> <span class="cm-string">"Storage level for a cached RDD:     "</span>, <span class="cm-variable">filteredRDD</span>.<span class="cm-variable">getStorageLevel</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 130px;"></div><div style="display: none; height: 160px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Storage level for a non cached RDD:  Serialized 1x Replicated
Storage level for a cached RDD:      Memory Serialized 1x Replicated
</pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 52px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 22.0257px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-3">### </span><span class="cm-strong cm-header cm-header-3">** Part 8: Debugging Spark applications and lazy evaluation **</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 52px;"></div><div style="display: none; height: 82px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h3 id="-Part-8:-Debugging-Spark-applications-and-lazy-evaluation-"><strong> Part 8: Debugging Spark applications and lazy evaluation </strong><a href="#-Part-8:-Debugging-Spark-applications-and-lazy-evaluation-" class="anchor-link">¶</a></h3>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 249px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** How Python is Executed in Spark **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Internally, Spark executes using a Java Virtual Machine (JVM). pySpark runs Python code in a JVM using </span><span class="cm-link cm-header cm-header-4">[Py4J]</span><span class="cm-string">(http://py4j.sourceforge.net)</span><span class="cm-header cm-header-4">. Py4J enables Python programs running in a Python interpreter to dynamically access Java objects in a Java Virtual Machine. Methods are called as if the Java objects resided in the Python interpreter and Java collections can be accessed through standard Python collection methods. Py4J also enables Java programs to call back Python objects.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Because pySpark uses Py4J, coding errors often result in a complicated, confusing stack trace that can be difficult to understand. In the following section, we'll explore how to understand stack traces.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 249px;"></div><div style="display: none; height: 279px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-How-Python-is-Executed-in-Spark-"><strong> How Python is Executed in Spark </strong><a href="#-How-Python-is-Executed-in-Spark-" class="anchor-link">¶</a></h4>
<h4 id="Internally,-Spark-executes-using-a-Java-Virtual-Machine-(JVM).-pySpark-runs-Python-code-in-a-JVM-using-Py4J.-Py4J-enables-Python-programs-running-in-a-Python-interpreter-to-dynamically-access-Java-objects-in-a-Java-Virtual-Machine.-Methods-are-called-as-if-the-Java-objects-resided-in-the-Python-interpreter-and-Java-collections-can-be-accessed-through-standard-Python-collection-methods.-Py4J-also-enables-Java-programs-to-call-back-Python-objects.">Internally, Spark executes using a Java Virtual Machine (JVM). pySpark runs Python code in a JVM using <a target="_blank" href="http://py4j.sourceforge.net/">Py4J</a>.
 Py4J enables Python programs running in a Python interpreter to 
dynamically access Java objects in a Java Virtual Machine. Methods are 
called as if the Java objects resided in the Python interpreter and Java
 collections can be accessed through standard Python collection methods.
 Py4J also enables Java programs to call back Python objects.<a href="#Internally,-Spark-executes-using-a-Java-Virtual-Machine-%28JVM%29.-pySpark-runs-Python-code-in-a-JVM-using-Py4J.-Py4J-enables-Python-programs-running-in-a-Python-interpreter-to-dynamically-access-Java-objects-in-a-Java-Virtual-Machine.-Methods-are-called-as-if-the-Java-objects-resided-in-the-Python-interpreter-and-Java-collections-can-be-accessed-through-standard-Python-collection-methods.-Py4J-also-enables-Java-programs-to-call-back-Python-objects." class="anchor-link">¶</a></h4>
<h4 id="Because-pySpark-uses-Py4J,-coding-errors-often-result-in-a-complicated,-confusing-stack-trace-that-can-be-difficult-to-understand.-In-the-following-section,-we'll-explore-how-to-understand-stack-traces.">Because
 pySpark uses Py4J, coding errors often result in a complicated, 
confusing stack trace that can be difficult to understand. In the 
following section, we'll explore how to understand stack traces.<a href="#Because-pySpark-uses-Py4J,-coding-errors-often-result-in-a-complicated,-confusing-stack-trace-that-can-be-difficult-to-understand.-In-the-following-section,-we%27ll-explore-how-to-understand-stack-traces." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 249px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 21.2005px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (8a) Challenges with lazy evaluation using transformations and actions **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Spark's use of lazy evaluation can make debugging more difficult because code is not always executed immediately. To see an example of how this can happen, let's first define a broken filter function.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Next we perform a </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> operation using the broken filtering function.  No error will occur at this point due to Spark's use of lazy evaluation.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### The </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> method will not be executed </span><span class="cm-em cm-header cm-header-4">*until*</span><span class="cm-header cm-header-4"> an action operation is invoked on the RDD.  We will perform an action by using the </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> method to return a list that contains all of the elements in this RDD.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 249px;"></div><div style="display: none; height: 279px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(8a)-Challenges-with-lazy-evaluation-using-transformations-and-actions-"><strong> (8a) Challenges with lazy evaluation using transformations and actions </strong><a href="#-%288a%29-Challenges-with-lazy-evaluation-using-transformations-and-actions-" class="anchor-link">¶</a></h4>
<h4 id="Spark's-use-of-lazy-evaluation-can-make-debugging-more-difficult-because-code-is-not-always-executed-immediately.-To-see-an-example-of-how-this-can-happen,-let's-first-define-a-broken-filter-function.">Spark's
 use of lazy evaluation can make debugging more difficult because code 
is not always executed immediately. To see an example of how this can 
happen, let's first define a broken filter function.<a href="#Spark%27s-use-of-lazy-evaluation-can-make-debugging-more-difficult-because-code-is-not-always-executed-immediately.-To-see-an-example-of-how-this-can-happen,-let%27s-first-define-a-broken-filter-function." class="anchor-link">¶</a></h4>
<h4 id="Next-we-perform-a-filter()-operation-using-the-broken-filtering-function.--No-error-will-occur-at-this-point-due-to-Spark's-use-of-lazy-evaluation.">Next we perform a <code>filter()</code> operation using the broken filtering function.  No error will occur at this point due to Spark's use of lazy evaluation.<a href="#Next-we-perform-a-filter%28%29-operation-using-the-broken-filtering-function.--No-error-will-occur-at-this-point-due-to-Spark%27s-use-of-lazy-evaluation." class="anchor-link">¶</a></h4>
<h4 id="The-filter()-method-will-not-be-executed-until-an-action-operation-is-invoked-on-the-RDD.--We-will-perform-an-action-by-using-the-collect()-method-to-return-a-list-that-contains-all-of-the-elements-in-this-RDD.">The <code>filter()</code> method will not be executed <em>until</em> an action operation is invoked on the RDD.  We will perform an action by using the <code>collect()</code> method to return a list that contains all of the elements in this RDD.<a href="#The-filter%28%29-method-will-not-be-executed-until-an-action-operation-is-invoked-on-the-RDD.--We-will-perform-an-action-by-using-the-collect%28%29-method-to-return-a-list-that-contains-all-of-the-elements-in-this-RDD." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[108]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 114.8px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">brokenTen</textarea></div><div style="min-width: 18px; bottom: 0px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 801px; margin-bottom: 0px; border-right-width: 30px; min-height: 385px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 33.6px; top: 0px; width: 75.6px; height: 17px;" class="CodeMirror-selected"></div></div><div style="" class="CodeMirror-cursors"></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-keyword">def</span> <span class="cm-def">brokenTen</span>(<span class="cm-variable">value</span>):</span></pre><pre class=""><span>    <span class="cm-string">"""Incorrect implementation of the ten function.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Note:</span></span></pre><pre class=""><span><span class="cm-string">        The `if` statement checks an undefined variable `val` instead of `value`.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Args:</span></span></pre><pre class=""><span><span class="cm-string">        value (int): A number.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Returns:</span></span></pre><pre class=""><span><span class="cm-string">        bool: Whether `value` is less than ten.</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-string">    Raises:</span></span></pre><pre class=""><span><span class="cm-string">        NameError: The function references `val`, which is not available in the local or global</span></span></pre><pre class=""><span><span class="cm-string">            namespace, so a `NameError` is raised.</span></span></pre><pre class=""><span><span class="cm-string">    """</span></span></pre><pre class=""><span>    <span class="cm-keyword">if</span> (<span class="cm-variable">val</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>):</span></pre><pre class=""><span>        <span class="cm-keyword">return</span> <span class="cm-builtin">True</span></span></pre><pre class=""><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=""><span>        <span class="cm-keyword">return</span> <span class="cm-builtin">False</span></span></pre><pre class=""><span><span>​</span></span></pre><pre class=""><span><span class="cm-variable">brokenRDD</span> = <span class="cm-variable">subRDD</span>.<span class="cm-builtin">filter</span>(<span class="cm-variable">brokenTen</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 385px;"></div><div style="display: none; height: 415px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell rendered unselected"><div class="input"><div class="prompt input_prompt">In&nbsp;[112]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 165.2px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off">brokenRDD.collect()</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 213px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div style="visibility: hidden;" class="CodeMirror-cursors"><div style="left: 159.6px; top: 17px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Now we'll see the error</span></span></pre><pre><span><span class="cm-variable">brokenRDD</span>.<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to scroll output; double click to hide" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_error"><pre><span class="ansired">---------------------------------------------------------------------------</span>
<span class="ansired">Py4JJavaError</span>                             Traceback (most recent call last)
<span class="ansigreen">&lt;ipython-input-112-c7025769b408&gt;</span> in <span class="ansicyan">&lt;module&gt;<span class="ansiblue">()</span>
<span class="ansigreen">      1</span> <span class="ansired"># Now we'll see the error</span><span class="ansiyellow"></span><span class="ansiyellow"></span>
<span class="ansigreen">----&gt; 2<span class="ansiyellow"> </span>brokenRDD<span class="ansiyellow">.</span>collect<span class="ansiyellow">(</span><span class="ansiyellow">)</span><span class="ansiyellow"></span>

<span class="ansigreen">/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/pyspark/rdd.py</span> in <span class="ansicyan">collect<span class="ansiblue">(self)</span>
<span class="ansigreen">    711</span>         """
<span class="ansigreen">    712</span>         <span class="ansigreen">with</span> SCCallSiteSync<span class="ansiyellow">(</span>self<span class="ansiyellow">.</span>context<span class="ansiyellow">)</span> <span class="ansigreen">as</span> css<span class="ansiyellow">:</span><span class="ansiyellow"></span>
<span class="ansigreen">--&gt; 713<span class="ansiyellow">             </span>port <span class="ansiyellow">=</span> self<span class="ansiyellow">.</span>ctx<span class="ansiyellow">.</span>_jvm<span class="ansiyellow">.</span>PythonRDD<span class="ansiyellow">.</span>collectAndServe<span class="ansiyellow">(</span>self<span class="ansiyellow">.</span>_jrdd<span class="ansiyellow">.</span>rdd<span class="ansiyellow">(</span><span class="ansiyellow">)</span><span class="ansiyellow">)</span><span class="ansiyellow"></span>
<span class="ansigreen">    714</span>         <span class="ansigreen">return</span> list<span class="ansiyellow">(</span>_load_from_socket<span class="ansiyellow">(</span>port<span class="ansiyellow">,</span> self<span class="ansiyellow">.</span>_jrdd_deserializer<span class="ansiyellow">)</span><span class="ansiyellow">)</span><span class="ansiyellow"></span>
<span class="ansigreen">    715</span> <span class="ansiyellow"></span>

<span class="ansigreen">/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class="ansicyan">__call__<span class="ansiblue">(self, *args)</span>
<span class="ansigreen">    536</span>         answer <span class="ansiyellow">=</span> self<span class="ansiyellow">.</span>gateway_client<span class="ansiyellow">.</span>send_command<span class="ansiyellow">(</span>command<span class="ansiyellow">)</span><span class="ansiyellow"></span>
<span class="ansigreen">    537</span>         return_value = get_return_value(answer, self.gateway_client,
<span class="ansigreen">--&gt; 538<span class="ansiyellow">                 self.target_id, self.name)
</span><span class="ansigreen">    539</span> <span class="ansiyellow"></span>
<span class="ansigreen">    540</span>         <span class="ansigreen">for</span> temp_arg <span class="ansigreen">in</span> temp_args<span class="ansiyellow">:</span><span class="ansiyellow"></span>

<span class="ansigreen">/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class="ansicyan">get_return_value<span class="ansiblue">(answer, gateway_client, target_id, name)</span>
<span class="ansigreen">    298</span>                 raise Py4JJavaError(
<span class="ansigreen">    299</span>                     <span class="ansiblue">'An error occurred while calling {0}{1}{2}.\n'</span><span class="ansiyellow">.</span><span class="ansiyellow"></span>
<span class="ansigreen">--&gt; 300<span class="ansiyellow">                     format(target_id, '.', name), value)
</span><span class="ansigreen">    301</span>             <span class="ansigreen">else</span><span class="ansiyellow">:</span><span class="ansiyellow"></span>
<span class="ansigreen">    302</span>                 raise Py4JError(

<span class="ansired">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 119.0 failed 1 times, most recent failure: Lost task 0.0 in stage 119.0 (TID 677, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/pyspark/worker.py", line 101, in main
    process()
  File "/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/pyspark/worker.py", line 96, in process
    serializer.dump_stream(func(split_index, iterator), outfile)
  File "/usr/local/bin/spark-1.3.1-bin-hadoop2.6/python/pyspark/serializers.py", line 236, in dump_stream
    vs = list(itertools.islice(iterator, batch))
  File "&lt;ipython-input-108-775c9f3488e3&gt;", line 17, in brokenTen
NameError: global name 'val' is not defined

	at org.apache.spark.api.python.PythonRDD$$anon$1.read(PythonRDD.scala:135)
	at org.apache.spark.api.python.PythonRDD$$anon$1.&lt;init&gt;(PythonRDD.scala:176)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:94)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:277)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:244)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:61)
	at org.apache.spark.scheduler.Task.run(Task.scala:64)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:203)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1204)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1193)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1192)
	at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1192)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:693)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:693)
	at scala.Option.foreach(Option.scala:236)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:693)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1393)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1354)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)


</span></span></span></span></span></span></span></span></pre></div></div></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60156px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 286px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (8b) Finding the bug **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### When the </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> method is executed, Spark evaluates the RDD by executing the </span><span class="cm-comment cm-header cm-header-4">`parallelize()`</span><span class="cm-header cm-header-4"> and </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> methods. Since our </span><span class="cm-comment cm-header cm-header-4">`filter()`</span><span class="cm-header cm-header-4"> method has an error in the filtering function </span><span class="cm-comment cm-header cm-header-4">`brokenTen()`</span><span class="cm-header cm-header-4">, an error occurs.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Scroll through the output "Py4JJavaError     Traceback (most recent call last)" part of the cell and first you will see that the line that generated the error is the </span><span class="cm-comment cm-header cm-header-4">`collect()`</span><span class="cm-header cm-header-4"> method line. There is </span><span class="cm-em cm-header cm-header-4">*nothing wrong with this line*</span><span class="cm-header cm-header-4">. However, it is an action and that caused other methods to be executed. Continue scrolling through the Traceback and you will see the following error line:</span></span></pre><pre class=""><span>    <span class="cm-comment">NameError: global name 'val' is not defined</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Looking at this error line, we can see that we used the wrong variable name in our filtering function </span><span class="cm-comment cm-header cm-header-4">`brokenTen()`</span><span class="cm-header cm-header-4">.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 286px;"></div><div style="display: none; height: 316px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(8b)-Finding-the-bug-"><strong> (8b) Finding the bug </strong><a href="#-%288b%29-Finding-the-bug-" class="anchor-link">¶</a></h4>
<h4 id="When-the-filter()-method-is-executed,-Spark-evaluates-the-RDD-by-executing-the-parallelize()-and-filter()-methods.-Since-our-filter()-method-has-an-error-in-the-filtering-function-brokenTen(),-an-error-occurs.">When the <code>filter()</code> method is executed, Spark evaluates the RDD by executing the <code>parallelize()</code> and <code>filter()</code> methods. Since our <code>filter()</code> method has an error in the filtering function <code>brokenTen()</code>, an error occurs.<a href="#When-the-filter%28%29-method-is-executed,-Spark-evaluates-the-RDD-by-executing-the-parallelize%28%29-and-filter%28%29-methods.-Since-our-filter%28%29-method-has-an-error-in-the-filtering-function-brokenTen%28%29,-an-error-occurs." class="anchor-link">¶</a></h4>
<h4 id="Scroll-through-the-output-&quot;Py4JJavaError-----Traceback-(most-recent-call-last)&quot;-part-of-the-cell-and-first-you-will-see-that-the-line-that-generated-the-error-is-the-collect()-method-line.-There-is-nothing-wrong-with-this-line.-However,-it-is-an-action-and-that-caused-other-methods-to-be-executed.-Continue-scrolling-through-the-Traceback-and-you-will-see-the-following-error-line:">Scroll
 through the output "Py4JJavaError     Traceback (most recent call 
last)" part of the cell and first you will see that the line that 
generated the error is the <code>collect()</code> method line. There is <em>nothing wrong with this line</em>.
 However, it is an action and that caused other methods to be executed. 
Continue scrolling through the Traceback and you will see the following 
error line:<a href="#Scroll-through-the-output-%22Py4JJavaError-----Traceback-%28most-recent-call-last%29%22-part-of-the-cell-and-first-you-will-see-that-the-line-that-generated-the-error-is-the-collect%28%29-method-line.-There-is-nothing-wrong-with-this-line.-However,-it-is-an-action-and-that-caused-other-methods-to-be-executed.-Continue-scrolling-through-the-Traceback-and-you-will-see-the-following-error-line:" class="anchor-link">¶</a></h4>
<pre><code>NameError: global name 'val' is not defined
</code></pre><h4 id="Looking-at-this-error-line,-we-can-see-that-we-used-the-wrong-variable-name-in-our-filtering-function-brokenTen().">Looking at this error line, we can see that we used the wrong variable name in our filtering function <code>brokenTen()</code>.<a href="#Looking-at-this-error-line,-we-can-see-that-we-used-the-wrong-variable-name-in-our-filtering-function-brokenTen%28%29." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 294px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (8c) Moving toward expert style **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### As you are learning Spark, I recommend that you write your code in the form:</span></span></pre><pre class=""><span>    <span class="cm-comment">RDD.transformation1()</span></span></pre><pre class=""><span>    <span class="cm-comment">RDD.action1()</span></span></pre><pre class=""><span>    <span class="cm-comment">RDD.transformation2()</span></span></pre><pre class=""><span>    <span class="cm-comment">RDD.action2()</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Using this style will make debugging your code much easier as it makes errors easier to localize - errors in your transformations will occur when the next action is executed.</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### Once you become more experienced with Spark, you can write your code with the form:</span></span></pre><pre class=""><span>    <span class="cm-comment">RDD.transformation1().transformation2().action()</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### We can also use </span><span class="cm-comment cm-header cm-header-4">`lambda()`</span><span class="cm-header cm-header-4"> functions instead of separately defined functions when their use improves readability and conciseness.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 294px;"></div><div style="display: none; height: 324px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(8c)-Moving-toward-expert-style-"><strong> (8c) Moving toward expert style </strong><a href="#-%288c%29-Moving-toward-expert-style-" class="anchor-link">¶</a></h4>
<h4 id="As-you-are-learning-Spark,-I-recommend-that-you-write-your-code-in-the-form:">As you are learning Spark, I recommend that you write your code in the form:<a href="#As-you-are-learning-Spark,-I-recommend-that-you-write-your-code-in-the-form:" class="anchor-link">¶</a></h4>
<pre><code>RDD.transformation1()
RDD.action1()
RDD.transformation2()
RDD.action2()
</code></pre><h4 id="Using-this-style-will-make-debugging-your-code-much-easier-as-it-makes-errors-easier-to-localize---errors-in-your-transformations-will-occur-when-the-next-action-is-executed.">Using
 this style will make debugging your code much easier as it makes errors
 easier to localize - errors in your transformations will occur when the
 next action is executed.<a href="#Using-this-style-will-make-debugging-your-code-much-easier-as-it-makes-errors-easier-to-localize---errors-in-your-transformations-will-occur-when-the-next-action-is-executed." class="anchor-link">¶</a></h4>
<h4 id="Once-you-become-more-experienced-with-Spark,-you-can-write-your-code-with-the-form:">Once you become more experienced with Spark, you can write your code with the form:<a href="#Once-you-become-more-experienced-with-Spark,-you-can-write-your-code-with-the-form:" class="anchor-link">¶</a></h4>
<pre><code>RDD.transformation1().transformation2().action()
</code></pre><h4 id="We-can-also-use-lambda()-functions-instead-of-separately-defined-functions-when-their-use-improves-readability-and-conciseness.">We can also use <code>lambda()</code> functions instead of separately defined functions when their use improves readability and conciseness.<a href="#We-can-also-use-lambda%28%29-functions-instead-of-separately-defined-functions-when-their-use-improves-readability-and-conciseness." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell unselected rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 347.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Cleaner code through lambda use</span></span></pre><pre class=""><span><span class="cm-variable">subRDD</span>.<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>).<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to expand output; double click to hide output" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell code_cell unselected rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.59999px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="right: 0px; left: 0px;" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 641.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 17px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Even better by moving our chain of operators into a single line.</span></span></pre><pre class=""><span><span class="cm-variable">sc</span>.<span class="cm-variable">parallelize</span>(<span class="cm-variable">data</span>).<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">y</span>: <span class="cm-variable">y</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>).<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>).<span class="cm-variable">collect</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div style="display: none; height: 75px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to expand output; double click to hide output" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div><div tabindex="2" class="cell text_cell rendered unselected"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"></textarea></div><div style="bottom: 0px; min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 90px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div style="left: 0px; top: 0px; height: 19.8px;" class="CodeMirror-cursor">&nbsp;</div></div><div class="CodeMirror-code"><pre class=""><span><span class="cm-header cm-header-4">#### </span><span class="cm-strong cm-header cm-header-4">** (8d) Readability and code style **</span></span></pre><pre class=""><span><span class="cm-header cm-header-4">#### To make the expert coding style more readable, enclose the statement in parentheses and put each method, transformation, or action on a separate line.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 90px;"></div><div style="display: none; height: 120px;" class="CodeMirror-gutters"></div></div></div></div><div tabindex="-1" class="text_cell_render rendered_html"><h4 id="-(8d)-Readability-and-code-style-"><strong> (8d) Readability and code style </strong><a href="#-%288d%29-Readability-and-code-style-" class="anchor-link">¶</a></h4>
<h4 id="To-make-the-expert-coding-style-more-readable,-enclose-the-statement-in-parentheses-and-put-each-method,-transformation,-or-action-on-a-separate-line.">To
 make the expert coding style more readable, enclose the statement in 
parentheses and put each method, transformation, or action on a separate
 line.<a href="#To-make-the-expert-coding-style-more-readable,-enclose-the-statement-in-parentheses-and-put-each-method,-transformation,-or-action-on-a-separate-line." class="anchor-link">¶</a></h4>
</div></div></div><div tabindex="2" class="cell code_cell rendered selected"><div class="input"><div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.6px; left: 106.4px;"><textarea tabindex="0" spellcheck="false" autocapitalize="off" autocorrect="off" style="position: absolute; padding: 0px; width: 1px; height: 1em; outline: medium none;" wrap="off"># Final version
(sc
 .parallelize(data)
 .map(lambda y: y - 1)
 .filter(lambda x: x &lt; 10)
 .collect())</textarea></div><div style="min-width: 18px;" not-content="true" class="CodeMirror-vscrollbar"><div style="min-width: 1px; height: 0px;"></div></div><div style="" not-content="true" class="CodeMirror-hscrollbar"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div not-content="true" class="CodeMirror-scrollbar-filler"></div><div not-content="true" class="CodeMirror-gutter-filler"></div><div draggable="true" tabindex="-1" class="CodeMirror-scroll"><div style="margin-left: 0px; min-width: 221.4px; margin-bottom: 0px; border-right-width: 30px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;" class="CodeMirror-sizer"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div style="position: absolute; left: 0px; top: 0px; width: 1005px; height: 17px;" class="CodeMirror-selected"></div><div style="position: absolute; left: 0px; top: 85px; width: 100.8px; height: 17px;" class="CodeMirror-selected"></div><div style="position: absolute; left: 0px; top: 17px; width: 1005px; height: 68px;" class="CodeMirror-selected"></div></div><div style="" class="CodeMirror-cursors"></div><div style="" class="CodeMirror-code"><pre class=""><span><span class="cm-comment"># Final version</span></span></pre><pre class=""><span>(<span class="cm-variable">sc</span></span></pre><pre class=""><span> .<span class="cm-variable">parallelize</span>(<span class="cm-variable">data</span>)</span></pre><pre class=""><span> .<span class="cm-builtin">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">y</span>: <span class="cm-variable">y</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>)</span></pre><pre class=""><span> .<span class="cm-builtin">filter</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-variable">x</span> <span class="cm-operator">&lt;</span> <span class="cm-number">10</span>)</span></pre><pre class=""><span> .<span class="cm-variable">collect</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 113px;"></div><div style="display: none; height: 143px;" class="CodeMirror-gutters"></div></div></div></div></div></div><div style="display: none;" class="widget-area"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div title="click to expand output; double click to hide output" class="out_prompt_overlay prompt" style=""></div><div style="" class="output"></div><div title="click to expand output" class="btn btn-default output_collapsed" style="display: none;">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a class="ui-button" role="button" href="#"><span class="ui-icon ui-icon-close">Close</span></a><a title="Grow the tooltip vertically (press shift-tab twice)" id="expanbutton" role="button" class="ui-corner-all" href="#"><span class="ui-icon ui-icon-plus">Expand</span></a><a title="show the current docstring in pager (press shift-tab 4 times)" class="ui-button" role="button" href="#"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a style="display: none;" title="Tooltip will linger for 10 seconds while you type" class="ui-button" role="button" href="#"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div class="ui-resizable" id="pager">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a class="ui-button" title="Open the pager in an external window" role="button"><span class="ui-icon ui-icon-extlink"></span></a><a class="ui-button" title="Close the pager" role="button"><span class="ui-icon ui-icon-close"></span></a></div>
<div style="z-index: 90;" class="ui-resizable-handle ui-resizable-n"></div></div>






<script type="text/javascript">
    sys_info = {"os_name": "posix", "sys_version": "2.7.6 (default, Mar 22 2014, 22:59:38) \n[GCC 4.8.2]", "default_encoding": "ANSI_X3.4-1968", "sys_platform": "linux2", "ipython_version": "3.1.0", "ipython_path": "/usr/local/lib/python2.7/dist-packages/IPython", "commit_source": "installation", "platform": "Linux-3.13.0-53-generic-i686-with-Ubuntu-14.04-trusty", "sys_executable": "/usr/bin/python", "commit_hash": "cbccb68"};
</script>

<script src="spark_tutorial_student.read-only_files/encoding.js" charset="utf-8"></script>

<script src="spark_tutorial_student.read-only_files/main.js" charset="utf-8"></script>





<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXSizeOneSym,sans-serif;" id="MathJax_Font_Test"></div></div></body></html>